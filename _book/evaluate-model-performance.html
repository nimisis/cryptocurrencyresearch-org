<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section - 7 Evaluate Model Performance | Cryptocurrency Research</title>
  <meta name="description" content="Section - 7 Evaluate Model Performance | Cryptocurrency Research" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Section - 7 Evaluate Model Performance | Cryptocurrency Research" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section - 7 Evaluate Model Performance | Cryptocurrency Research" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="predictive-modeling.html"/>
<link rel="next" href="time-series.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.15/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Cryptocurrency Research</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-will-i-learn"><i class="fa fa-check"></i><b>1.1</b> What will I learn?</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#before-getting-started"><i class="fa fa-check"></i><b>1.2</b> Before Getting Started</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#high-level-version"><i class="fa fa-check"></i><b>1.2.1</b> High-Level Version</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#format-notes"><i class="fa fa-check"></i><b>1.3</b> Format Notes</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#plan-of-attack"><i class="fa fa-check"></i><b>1.4</b> Plan of Attack</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#github-repository"><i class="fa fa-check"></i><b>1.5</b> GitHub Repository</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#disclaimer"><i class="fa fa-check"></i><b>1.6</b> Disclaimer</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="setup.html"><a href="setup.html"><i class="fa fa-check"></i><b>2</b> Setup and Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="setup.html"><a href="setup.html#option-1---run-in-the-cloud"><i class="fa fa-check"></i><b>2.1</b> Option 1 - Run in the Cloud</a></li>
<li class="chapter" data-level="2.2" data-path="setup.html"><a href="setup.html#option-2---run-locally"><i class="fa fa-check"></i><b>2.2</b> Option 2 - Run Locally</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="setup.html"><a href="setup.html#setup-r"><i class="fa fa-check"></i><b>2.2.1</b> Setup R</a></li>
<li class="chapter" data-level="2.2.2" data-path="setup.html"><a href="setup.html#installing-and-loading-packages"><i class="fa fa-check"></i><b>2.2.2</b> Installing and Loading Packages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="explore-data.html"><a href="explore-data.html"><i class="fa fa-check"></i><b>3</b> Explore the Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="explore-data.html"><a href="explore-data.html#pull-the-data"><i class="fa fa-check"></i><b>3.1</b> Pull the Data</a></li>
<li class="chapter" data-level="3.2" data-path="explore-data.html"><a href="explore-data.html#data-preview"><i class="fa fa-check"></i><b>3.2</b> Data Preview</a></li>
<li class="chapter" data-level="3.3" data-path="explore-data.html"><a href="explore-data.html#the-definition-of-a-price"><i class="fa fa-check"></i><b>3.3</b> The definition of a “price”</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="explore-data.html"><a href="explore-data.html#in-summary"><i class="fa fa-check"></i><b>3.3.1</b> In Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="explore-data.html"><a href="explore-data.html#data-quality"><i class="fa fa-check"></i><b>3.4</b> Data Quality</a></li>
<li class="chapter" data-level="3.5" data-path="explore-data.html"><a href="explore-data.html#data-source-details"><i class="fa fa-check"></i><b>3.5</b> Data Source Details</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>4</b> Data Prep</a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-prep.html"><a href="data-prep.html#remove-nulls"><i class="fa fa-check"></i><b>4.1</b> Remove Nulls</a></li>
<li class="chapter" data-level="4.2" data-path="data-prep.html"><a href="data-prep.html#calculate-price_usd-column"><i class="fa fa-check"></i><b>4.2</b> Calculate <code>price_usd</code> Column</a></li>
<li class="chapter" data-level="4.3" data-path="data-prep.html"><a href="data-prep.html#clean-data-by-group"><i class="fa fa-check"></i><b>4.3</b> Clean Data by Group</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-prep.html"><a href="data-prep.html#remove-symbols-without-enough-rows"><i class="fa fa-check"></i><b>4.3.1</b> Remove symbols without enough rows</a></li>
<li class="chapter" data-level="4.3.2" data-path="data-prep.html"><a href="data-prep.html#remove-symbols-without-data-from-the-last-3-days"><i class="fa fa-check"></i><b>4.3.2</b> Remove symbols without data from the last 3 days</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-prep.html"><a href="data-prep.html#calculate-target"><i class="fa fa-check"></i><b>4.4</b> Calculate Target</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-prep.html"><a href="data-prep.html#any-gaps"><i class="fa fa-check"></i><b>4.4.1</b> Any gaps?</a></li>
<li class="chapter" data-level="4.4.2" data-path="data-prep.html"><a href="data-prep.html#convert-to-tsibble"><i class="fa fa-check"></i><b>4.4.2</b> Convert to tsibble</a></li>
<li class="chapter" data-level="4.4.3" data-path="data-prep.html"><a href="data-prep.html#scan-gaps"><i class="fa fa-check"></i><b>4.4.3</b> Scan gaps</a></li>
<li class="chapter" data-level="4.4.4" data-path="data-prep.html"><a href="data-prep.html#fill-gaps"><i class="fa fa-check"></i><b>4.4.4</b> Fill gaps</a></li>
<li class="chapter" data-level="4.4.5" data-path="data-prep.html"><a href="data-prep.html#calculate-target-1"><i class="fa fa-check"></i><b>4.4.5</b> Calculate Target</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-prep.html"><a href="data-prep.html#cross-validation"><i class="fa fa-check"></i><b>4.5</b> Cross Validation</a></li>
<li class="chapter" data-level="4.6" data-path="data-prep.html"><a href="data-prep.html#fix-data-by-split"><i class="fa fa-check"></i><b>4.6</b> Fix Data by Split</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-prep.html"><a href="data-prep.html#zero-variance"><i class="fa fa-check"></i><b>4.6.1</b> Zero Variance</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="data-prep.html"><a href="data-prep.html#nest-data"><i class="fa fa-check"></i><b>4.7</b> Nest data</a></li>
<li class="chapter" data-level="4.8" data-path="data-prep.html"><a href="data-prep.html#functional-programming"><i class="fa fa-check"></i><b>4.8</b> Functional Programming</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>5</b> Visualization 📉</a>
<ul>
<li class="chapter" data-level="5.1" data-path="visualization.html"><a href="visualization.html#basics---ggplot2"><i class="fa fa-check"></i><b>5.1</b> Basics - ggplot2</a></li>
<li class="chapter" data-level="5.2" data-path="visualization.html"><a href="visualization.html#using-extensions"><i class="fa fa-check"></i><b>5.2</b> Using Extensions</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="visualization.html"><a href="visualization.html#ggthemes"><i class="fa fa-check"></i><b>5.2.1</b> ggthemes</a></li>
<li class="chapter" data-level="5.2.2" data-path="visualization.html"><a href="visualization.html#plotly"><i class="fa fa-check"></i><b>5.2.2</b> plotly</a></li>
<li class="chapter" data-level="5.2.3" data-path="visualization.html"><a href="visualization.html#ggpubr"><i class="fa fa-check"></i><b>5.2.3</b> ggpubr</a></li>
<li class="chapter" data-level="5.2.4" data-path="visualization.html"><a href="visualization.html#ggforce"><i class="fa fa-check"></i><b>5.2.4</b> ggforce</a></li>
<li class="chapter" data-level="5.2.5" data-path="visualization.html"><a href="visualization.html#gganimate"><i class="fa fa-check"></i><b>5.2.5</b> gganimate</a></li>
<li class="chapter" data-level="5.2.6" data-path="visualization.html"><a href="visualization.html#ggtimeseries"><i class="fa fa-check"></i><b>5.2.6</b> ggTimeSeries</a></li>
<li class="chapter" data-level="5.2.7" data-path="visualization.html"><a href="visualization.html#rayshader"><i class="fa fa-check"></i><b>5.2.7</b> Rayshader</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="predictive-modeling.html"><a href="predictive-modeling.html"><i class="fa fa-check"></i><b>6</b> Predictive Modeling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#what-is-it"><i class="fa fa-check"></i><b>6.1</b> What is it?</a></li>
<li class="chapter" data-level="6.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#example-simple-model"><i class="fa fa-check"></i><b>6.2</b> Example Simple Model</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#using-functional-programming"><i class="fa fa-check"></i><b>6.2.1</b> Using Functional Programming</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="predictive-modeling.html"><a href="predictive-modeling.html#caret"><i class="fa fa-check"></i><b>6.3</b> Caret</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="predictive-modeling.html"><a href="predictive-modeling.html#parallel-processing"><i class="fa fa-check"></i><b>6.3.1</b> Parallel Processing</a></li>
<li class="chapter" data-level="6.3.2" data-path="predictive-modeling.html"><a href="predictive-modeling.html#functional-programming---here-or-elsewhere"><i class="fa fa-check"></i><b>6.3.2</b> Functional Programming - here or elsewhere?</a></li>
<li class="chapter" data-level="6.3.3" data-path="predictive-modeling.html"><a href="predictive-modeling.html#cross-validation-1"><i class="fa fa-check"></i><b>6.3.3</b> Cross Validation</a></li>
<li class="chapter" data-level="6.3.4" data-path="predictive-modeling.html"><a href="predictive-modeling.html#xgboost-models"><i class="fa fa-check"></i><b>6.3.4</b> XGBoost models</a></li>
<li class="chapter" data-level="6.3.5" data-path="predictive-modeling.html"><a href="predictive-modeling.html#all-other-models"><i class="fa fa-check"></i><b>6.3.5</b> All Other Models</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="predictive-modeling.html"><a href="predictive-modeling.html#make-predictions"><i class="fa fa-check"></i><b>6.4</b> Make Predictions</a></li>
<li class="chapter" data-level="6.5" data-path="predictive-modeling.html"><a href="predictive-modeling.html#traditional-timeseries"><i class="fa fa-check"></i><b>6.5</b> Traditional Timeseries</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html"><i class="fa fa-check"></i><b>7</b> Evaluate Model Performance</a>
<ul>
<li class="chapter" data-level="7.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#summarizing-models"><i class="fa fa-check"></i><b>7.1</b> Summarizing models</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#comparing-metrics"><i class="fa fa-check"></i><b>7.1.1</b> Comparing Metrics</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#adjust-prices"><i class="fa fa-check"></i><b>7.2</b> Adjust Prices</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#add-last-price"><i class="fa fa-check"></i><b>7.2.1</b> Add Last Price</a></li>
<li class="chapter" data-level="7.2.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#convert-to-percentage-change"><i class="fa fa-check"></i><b>7.2.2</b> Convert to Percentage Change</a></li>
<li class="chapter" data-level="7.2.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#actuals"><i class="fa fa-check"></i><b>7.2.3</b> Actuals</a></li>
<li class="chapter" data-level="7.2.4" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#actuals-as-change"><i class="fa fa-check"></i><b>7.2.4</b> Actuals as % Change</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#review-summary-statistics"><i class="fa fa-check"></i><b>7.3</b> Review Summary Statistics</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#calculate-rmse"><i class="fa fa-check"></i><b>7.3.1</b> Calculate RMSE</a></li>
<li class="chapter" data-level="7.3.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#calculate-r2"><i class="fa fa-check"></i><b>7.3.2</b> Calculate R^2</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#adjust-prices---all-models"><i class="fa fa-check"></i><b>7.4</b> Adjust Prices - All Models</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#add-last-price-1"><i class="fa fa-check"></i><b>7.4.1</b> Add Last Price</a></li>
<li class="chapter" data-level="7.4.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#convert-to-change"><i class="fa fa-check"></i><b>7.4.2</b> Convert to % Change</a></li>
<li class="chapter" data-level="7.4.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#add-metrics"><i class="fa fa-check"></i><b>7.4.3</b> Add Metrics</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#eval-rmse"><i class="fa fa-check"></i><b>7.5</b> Eval RMSE</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#test"><i class="fa fa-check"></i><b>7.5.1</b> Test</a></li>
<li class="chapter" data-level="7.5.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#holdout-3"><i class="fa fa-check"></i><b>7.5.2</b> Holdout</a></li>
<li class="chapter" data-level="7.5.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#union-results"><i class="fa fa-check"></i><b>7.5.3</b> Union Results</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#eval-r2"><i class="fa fa-check"></i><b>7.6</b> Eval R^2</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#test-1"><i class="fa fa-check"></i><b>7.6.1</b> Test</a></li>
<li class="chapter" data-level="7.6.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#holdout-4"><i class="fa fa-check"></i><b>7.6.2</b> Holdout</a></li>
<li class="chapter" data-level="7.6.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#union-results-1"><i class="fa fa-check"></i><b>7.6.3</b> Union Results</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#visualize-results"><i class="fa fa-check"></i><b>7.7</b> Visualize Results</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#rmse-visualization"><i class="fa fa-check"></i><b>7.7.1</b> RMSE Visualization</a></li>
<li class="chapter" data-level="7.7.2" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#both"><i class="fa fa-check"></i><b>7.7.2</b> Both</a></li>
<li class="chapter" data-level="7.7.3" data-path="evaluate-model-performance.html"><a href="evaluate-model-performance.html#results-by-the-cryptocurrency"><i class="fa fa-check"></i><b>7.7.3</b> Results by the Cryptocurrency</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>8</b> Time Series</a></li>
<li class="chapter" data-level="9" data-path="predictions.html"><a href="predictions.html"><i class="fa fa-check"></i><b>9</b> Predictions</a></li>
<li class="chapter" data-level="10" data-path="explain-predictions.html"><a href="explain-predictions.html"><i class="fa fa-check"></i><b>10</b> Explain Predictions</a></li>
<li class="chapter" data-level="11" data-path="considerations.html"><a href="considerations.html"><i class="fa fa-check"></i><b>11</b> Considerations</a>
<ul>
<li class="chapter" data-level="11.1" data-path="considerations.html"><a href="considerations.html#session-information"><i class="fa fa-check"></i><b>11.1</b> Session Information</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="archive.html"><a href="archive.html"><i class="fa fa-check"></i><b>12</b> Archive</a>
<ul>
<li class="chapter" data-level="12.1" data-path="archive.html"><a href="archive.html#may-2020"><i class="fa fa-check"></i><b>12.1</b> May 2020</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>13</b> References</a>
<ul>
<li class="chapter" data-level="13.1" data-path="references.html"><a href="references.html#resources-used"><i class="fa fa-check"></i><b>13.1</b> Resources Used</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="references.html"><a href="references.html#visualization-section"><i class="fa fa-check"></i><b>13.1.1</b> Visualization Section</a></li>
<li class="chapter" data-level="13.1.2" data-path="references.html"><a href="references.html#time-series-section"><i class="fa fa-check"></i><b>13.1.2</b> Time Series Section</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="references.html"><a href="references.html#packages-used-and-cited"><i class="fa fa-check"></i><b>13.2</b> Packages used and cited</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="blank"><img src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" width="80"></a></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Cryptocurrency Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="evaluate-model-performance" class="section level1" number="7">
<h1><span class="header-section-number">Section - 7</span> Evaluate Model Performance</h1>
<div id="summarizing-models" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Summarizing models</h2>
<!-- [TODO - HERE add notes on using **postResample()** and explain that if you think about it all you need to evaluate a model is the predictions made (on data never seen by the model) ] -->
<p>Example for one model:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="evaluate-model-performance.html#cb100-1" aria-hidden="true"></a><span class="kw">postResample</span>(<span class="dt">pred =</span> cryptodata_nested<span class="op">$</span>lm_test_predictions[[<span class="dv">1</span>]], </span>
<span id="cb100-2"><a href="evaluate-model-performance.html#cb100-2" aria-hidden="true"></a>             <span class="dt">obs =</span> cryptodata_nested<span class="op">$</span>test_data[[<span class="dv">1</span>]]<span class="op">$</span>target_price_24h)</span></code></pre></div>
<pre><code>##      RMSE  Rsquared       MAE 
## 0.5295418 0.1330962 0.3814626</code></pre>
<p>We can extract the first element to return the <strong>RMSE</strong> metric, and the second element for the <strong>R Squared (R^2)</strong> metric. We are using <strong><code>[[1]]</code></strong> to extract the first element of the <span style="color: blue;"><strong>lm_test_predictions</strong></span> and <span style="color: blue;"><strong>test_data</strong></span> and compare the predictions to the actual value of the <span style="color: blue;"><strong>target_price24h</strong></span> column.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="evaluate-model-performance.html#cb102-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;Now showing RMSE example:&#39;</span>, <span class="kw">postResample</span>(<span class="dt">pred =</span> cryptodata_nested<span class="op">$</span>lm_test_predictions[[<span class="dv">1</span>]], </span>
<span id="cb102-2"><a href="evaluate-model-performance.html#cb102-2" aria-hidden="true"></a>                                                      <span class="dt">obs =</span> cryptodata_nested<span class="op">$</span>test_data[[<span class="dv">1</span>]]<span class="op">$</span>target_price_24h)[[<span class="dv">1</span>]]))</span></code></pre></div>
<pre><code>## [1] &quot;Now showing RMSE example: 0.529541790673164&quot;</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="evaluate-model-performance.html#cb104-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;Now showing R Squared example:&#39;</span>, <span class="kw">postResample</span>(<span class="dt">pred =</span> cryptodata_nested<span class="op">$</span>lm_test_predictions[[<span class="dv">1</span>]], </span>
<span id="cb104-2"><a href="evaluate-model-performance.html#cb104-2" aria-hidden="true"></a>                                                           <span class="dt">obs =</span> cryptodata_nested<span class="op">$</span>test_data[[<span class="dv">1</span>]]<span class="op">$</span>target_price_24h)[[<span class="dv">2</span>]]))</span></code></pre></div>
<pre><code>## [1] &quot;Now showing R Squared example: 0.13309619303999&quot;</code></pre>
<p>This model used the earliest subset of the data available for the cryptocurrency. How does the same model used to predict this older subset of the data perform when applied to the most recent subset of the data?</p>
<p>We can get the same summary of results on the <strong>holdout</strong>:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="evaluate-model-performance.html#cb106-1" aria-hidden="true"></a><span class="kw">postResample</span>(<span class="dt">pred =</span> cryptodata_nested<span class="op">$</span>lm_holdout_predictions[[<span class="dv">1</span>]], </span>
<span id="cb106-2"><a href="evaluate-model-performance.html#cb106-2" aria-hidden="true"></a>             <span class="dt">obs =</span> cryptodata_nested<span class="op">$</span>holdout_data[[<span class="dv">1</span>]]<span class="op">$</span>target_price_24h)</span></code></pre></div>
<pre><code>##      RMSE  Rsquared       MAE 
## 0.1878374 0.1296550 0.1383679</code></pre>
<!-- If we wrote a [*for loop*](https://r4ds.had.co.nz/iteration.html#for-loops) to iterate through all the options we would get the same results using an **object oriented approach**, this has to do with coding styles and preferences and generally speaking there are many ways of doing the same things in programming. -->
<div id="comparing-metrics" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Comparing Metrics</h3>
<p>How do these two results compare and why is this comparison important?</p>
<p>The <strong>RMSE</strong></p>
<!-- [TODO - ADD HERE explaining RMSE and R^2 metrics and how we will use them to standardize the way we evaluate the effectiveness of a model. We are looking to avoid using models where the results looked good for the test data but then perform much worse than that initial expectation when looking at the holdout results] -->
</div>
</div>
<div id="adjust-prices" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Adjust Prices</h2>
<!-- [TODO - add note on first doing lm only?] -->
<p>Because cryptocurrencies can vary dramatically in their prices with some trading in the tens of thousands of dollars and others trading for less than a cent, we need to make sure to standardize the RMSE columns to provide a fair comparison for the metric.</p>
<p>Therefore, before using the <code>postResample()</code> function, let’s convert both the predictions and the target to be the % change in price over the 24 hour period, rather than the change in price ($).</p>

<div class="infoicon">
This step is particularly tedious, but it is important. As with the rest of this tutorial, try to understand what we are doing and why even if you find the code overwhelming. All we are doing in this “Adjust Prices” section is we are adjusting all of the prices to be represented as percentage change between observations, which will allow us to draw a fair comparison of the metrics across all cryptocurrencies, which would not be possible using the prices themselves.
</div>
<div id="add-last-price" class="section level3" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Add Last Price</h3>
<!-- [TODO - write better] -->
<p>In order to convert the first prediction made to be a percentage, we need to know the previous price.</p>
<p>Function to add last_price_train column and append it to the predictions made so we can calculate the % change of the first element, before later removing the value not associated with the predictions:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="evaluate-model-performance.html#cb108-1" aria-hidden="true"></a>last_train_price &lt;-<span class="st"> </span><span class="cf">function</span>(train_data, predictions){</span>
<span id="cb108-2"><a href="evaluate-model-performance.html#cb108-2" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="kw">tail</span>(train_data<span class="op">$</span>price_usd,<span class="dv">1</span>), predictions)</span>
<span id="cb108-3"><a href="evaluate-model-performance.html#cb108-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>Now overwrite the old predictions:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="evaluate-model-performance.html#cb109-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb109-2"><a href="evaluate-model-performance.html#cb109-2" aria-hidden="true"></a>                            <span class="dt">lm_test_predictions =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb109-3"><a href="evaluate-model-performance.html#cb109-3" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(train_data, lm_test_predictions, last_train_price),</span>
<span id="cb109-4"><a href="evaluate-model-performance.html#cb109-4" aria-hidden="true"></a>                                                         <span class="ot">NA</span>))</span></code></pre></div>
<div id="holdout" class="section level4" number="7.2.1.1">
<h4><span class="header-section-number">7.2.1.1</span> Holdout</h4>
<p>Do the same for the holdout. For all of holdout need to take last price point of 5th training split.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="evaluate-model-performance.html#cb110-1" aria-hidden="true"></a>cryptodata_nested_holdout &lt;-<span class="st"> </span><span class="kw">mutate</span>(<span class="kw">filter</span>(cryptodata_nested, split <span class="op">==</span><span class="st"> </span><span class="dv">5</span>),</span>
<span id="cb110-2"><a href="evaluate-model-performance.html#cb110-2" aria-hidden="true"></a>                                    <span class="dt">lm_holdout_predictions =</span> <span class="kw">map2</span>(train_data, lm_holdout_predictions, last_train_price))</span></code></pre></div>
<p>Join the holdout data to all rows based on the cryptocurrency symbol alone:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="evaluate-model-performance.html#cb111-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">left_join</span>(cryptodata_nested, </span>
<span id="cb111-2"><a href="evaluate-model-performance.html#cb111-2" aria-hidden="true"></a>                               <span class="kw">select</span>(cryptodata_nested_holdout, symbol, lm_holdout_predictions),</span>
<span id="cb111-3"><a href="evaluate-model-performance.html#cb111-3" aria-hidden="true"></a>                               <span class="dt">by=</span><span class="st">&#39;symbol&#39;</span>)</span>
<span id="cb111-4"><a href="evaluate-model-performance.html#cb111-4" aria-hidden="true"></a><span class="co"># Remove unwanted columns</span></span>
<span id="cb111-5"><a href="evaluate-model-performance.html#cb111-5" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">select</span>(cryptodata_nested, <span class="op">-</span>lm_holdout_predictions.x, <span class="op">-</span>split.y)</span>
<span id="cb111-6"><a href="evaluate-model-performance.html#cb111-6" aria-hidden="true"></a><span class="co"># Rename the columns kept</span></span>
<span id="cb111-7"><a href="evaluate-model-performance.html#cb111-7" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">rename</span>(cryptodata_nested, </span>
<span id="cb111-8"><a href="evaluate-model-performance.html#cb111-8" aria-hidden="true"></a>                            <span class="dt">lm_holdout_predictions =</span> <span class="st">&#39;lm_holdout_predictions.y&#39;</span>,</span>
<span id="cb111-9"><a href="evaluate-model-performance.html#cb111-9" aria-hidden="true"></a>                            <span class="dt">split =</span> <span class="st">&#39;split.x&#39;</span>)</span>
<span id="cb111-10"><a href="evaluate-model-performance.html#cb111-10" aria-hidden="true"></a><span class="co"># Reset the correct grouping structure</span></span>
<span id="cb111-11"><a href="evaluate-model-performance.html#cb111-11" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">group_by</span>(cryptodata_nested, symbol, split)</span></code></pre></div>
</div>
</div>
<div id="convert-to-percentage-change" class="section level3" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Convert to Percentage Change</h3>
<!-- [TODO - CLEAN UP EXPLANATIONS HERE!] -->
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="evaluate-model-performance.html#cb112-1" aria-hidden="true"></a>standardize_perc_change &lt;-<span class="st"> </span><span class="cf">function</span>(predictions){</span>
<span id="cb112-2"><a href="evaluate-model-performance.html#cb112-2" aria-hidden="true"></a>  results &lt;-<span class="st"> </span>(<span class="kw">diff</span>(<span class="kw">c</span>(<span class="kw">lag</span>(predictions, <span class="dv">1</span>), predictions)) <span class="op">/</span><span class="st"> </span><span class="kw">lag</span>(predictions, <span class="dv">1</span>))<span class="op">*</span><span class="dv">100</span></span>
<span id="cb112-3"><a href="evaluate-model-performance.html#cb112-3" aria-hidden="true"></a>  <span class="co"># Exclude the first element, next element will be % change of first prediction</span></span>
<span id="cb112-4"><a href="evaluate-model-performance.html#cb112-4" aria-hidden="true"></a>  <span class="kw">tail</span>(<span class="kw">head</span>(results, <span class="kw">length</span>(predictions)), <span class="kw">length</span>(predictions)<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb112-5"><a href="evaluate-model-performance.html#cb112-5" aria-hidden="true"></a>}</span></code></pre></div>
<!-- [TODO - Show formula? It's (diff(V1, V2)/abs(V1))*100] -->
<p>Overwrite the old predictions with the new predictions adjusted as a percentage now:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="evaluate-model-performance.html#cb113-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb113-2"><a href="evaluate-model-performance.html#cb113-2" aria-hidden="true"></a>                            <span class="dt">lm_test_predictions =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb113-3"><a href="evaluate-model-performance.html#cb113-3" aria-hidden="true"></a>                                                         <span class="kw">map</span>(lm_test_predictions, standardize_perc_change),</span>
<span id="cb113-4"><a href="evaluate-model-performance.html#cb113-4" aria-hidden="true"></a>                                                         <span class="ot">NA</span>),</span>
<span id="cb113-5"><a href="evaluate-model-performance.html#cb113-5" aria-hidden="true"></a>                            <span class="co"># Holdout for all splits</span></span>
<span id="cb113-6"><a href="evaluate-model-performance.html#cb113-6" aria-hidden="true"></a>                            <span class="dt">lm_holdout_predictions =</span> <span class="kw">map</span>(lm_holdout_predictions, standardize_perc_change))</span></code></pre></div>
</div>
<div id="actuals" class="section level3" number="7.2.3">
<h3><span class="header-section-number">7.2.3</span> Actuals</h3>
<p>Now do the same thing to the actual prices. Let’s make a new column called <strong>actuals</strong> containing the real price values (rather than the predicted ones):</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="evaluate-model-performance.html#cb114-1" aria-hidden="true"></a>actuals_create &lt;-<span class="st"> </span><span class="cf">function</span>(train_data, test_data){</span>
<span id="cb114-2"><a href="evaluate-model-performance.html#cb114-2" aria-hidden="true"></a>  <span class="kw">c</span>(<span class="kw">tail</span>(train_data<span class="op">$</span>price_usd,<span class="dv">1</span>), <span class="kw">as.numeric</span>(<span class="kw">unlist</span>(<span class="kw">select</span>(test_data, price_usd))))</span>
<span id="cb114-3"><a href="evaluate-model-performance.html#cb114-3" aria-hidden="true"></a>}</span></code></pre></div>
<p>Use the new function to create the new column <code>actuals</code>:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="evaluate-model-performance.html#cb115-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb115-2"><a href="evaluate-model-performance.html#cb115-2" aria-hidden="true"></a>                            <span class="dt">actuals_test =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb115-3"><a href="evaluate-model-performance.html#cb115-3" aria-hidden="true"></a>                                             <span class="kw">map2</span>(train_data, test_data, actuals_create),</span>
<span id="cb115-4"><a href="evaluate-model-performance.html#cb115-4" aria-hidden="true"></a>                                             <span class="ot">NA</span>))</span></code></pre></div>
<div id="holdout-1" class="section level4" number="7.2.3.1">
<h4><span class="header-section-number">7.2.3.1</span> Holdout</h4>
<p>Again, for the holdout we need the price from the training data of the 5th split</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="evaluate-model-performance.html#cb116-1" aria-hidden="true"></a>cryptodata_nested_holdout &lt;-<span class="st"> </span><span class="kw">mutate</span>(<span class="kw">filter</span>(cryptodata_nested, split <span class="op">==</span><span class="st"> </span><span class="dv">5</span>),</span>
<span id="cb116-2"><a href="evaluate-model-performance.html#cb116-2" aria-hidden="true"></a>                                    <span class="dt">actuals_holdout =</span> <span class="kw">map2</span>(train_data, holdout_data, actuals_create))</span></code></pre></div>
<p>Join the holdout data to all rows based on the cryptocurrency symbol alone:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="evaluate-model-performance.html#cb117-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">left_join</span>(cryptodata_nested, </span>
<span id="cb117-2"><a href="evaluate-model-performance.html#cb117-2" aria-hidden="true"></a>                               <span class="kw">select</span>(cryptodata_nested_holdout, symbol, actuals_holdout),</span>
<span id="cb117-3"><a href="evaluate-model-performance.html#cb117-3" aria-hidden="true"></a>                               <span class="dt">by=</span><span class="st">&#39;symbol&#39;</span>)</span>
<span id="cb117-4"><a href="evaluate-model-performance.html#cb117-4" aria-hidden="true"></a><span class="co"># Remove unwanted columns</span></span>
<span id="cb117-5"><a href="evaluate-model-performance.html#cb117-5" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">select</span>(cryptodata_nested, <span class="op">-</span>split.y)</span>
<span id="cb117-6"><a href="evaluate-model-performance.html#cb117-6" aria-hidden="true"></a><span class="co"># Rename the columns kept</span></span>
<span id="cb117-7"><a href="evaluate-model-performance.html#cb117-7" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">rename</span>(cryptodata_nested, <span class="dt">split =</span> <span class="st">&#39;split.x&#39;</span>)</span>
<span id="cb117-8"><a href="evaluate-model-performance.html#cb117-8" aria-hidden="true"></a><span class="co"># Reset the correct grouping structure</span></span>
<span id="cb117-9"><a href="evaluate-model-performance.html#cb117-9" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">group_by</span>(cryptodata_nested, symbol, split)</span></code></pre></div>
</div>
</div>
<div id="actuals-as-change" class="section level3" number="7.2.4">
<h3><span class="header-section-number">7.2.4</span> Actuals as % Change</h3>
<p>Now we can convert the new <code>actuals</code> to express the <code>price_usd</code> as a % change relative to the previous value using adapting the function from earlier:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="evaluate-model-performance.html#cb118-1" aria-hidden="true"></a>actuals_perc_change &lt;-<span class="st"> </span><span class="cf">function</span>(predictions){</span>
<span id="cb118-2"><a href="evaluate-model-performance.html#cb118-2" aria-hidden="true"></a>  results &lt;-<span class="st"> </span>(<span class="kw">diff</span>(<span class="kw">c</span>(<span class="kw">lag</span>(predictions, <span class="dv">1</span>), predictions)) <span class="op">/</span><span class="st"> </span><span class="kw">lag</span>(predictions, <span class="dv">1</span>))<span class="op">*</span><span class="dv">100</span></span>
<span id="cb118-3"><a href="evaluate-model-performance.html#cb118-3" aria-hidden="true"></a>  <span class="co"># Exclude the first element, next element will be % change of first prediction</span></span>
<span id="cb118-4"><a href="evaluate-model-performance.html#cb118-4" aria-hidden="true"></a>  <span class="kw">tail</span>(<span class="kw">head</span>(results, <span class="kw">length</span>(predictions)), <span class="kw">length</span>(predictions)<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb118-5"><a href="evaluate-model-performance.html#cb118-5" aria-hidden="true"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="evaluate-model-performance.html#cb119-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb119-2"><a href="evaluate-model-performance.html#cb119-2" aria-hidden="true"></a>                            <span class="dt">actuals_test =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb119-3"><a href="evaluate-model-performance.html#cb119-3" aria-hidden="true"></a>                                             <span class="kw">map</span>(actuals_test, actuals_perc_change),</span>
<span id="cb119-4"><a href="evaluate-model-performance.html#cb119-4" aria-hidden="true"></a>                                             <span class="ot">NA</span>),</span>
<span id="cb119-5"><a href="evaluate-model-performance.html#cb119-5" aria-hidden="true"></a>                            <span class="dt">actuals_holdout =</span> <span class="kw">map</span>(actuals_holdout, actuals_perc_change))</span></code></pre></div>
</div>
</div>
<div id="review-summary-statistics" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Review Summary Statistics</h2>
<p>Now that we standardized the price to show the percentage change relative to the previous period instead of the price in dollars, we can actually compare the summary statistics across all cryptocurrencies and have it be a fair comparison.</p>
<p>Let’s get the same statistic as we did at the beginning of this section, but this time on the standardized values:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="evaluate-model-performance.html#cb120-1" aria-hidden="true"></a>hydroGOF<span class="op">::</span><span class="kw">rmse</span>(cryptodata_nested<span class="op">$</span>lm_test_predictions[[<span class="dv">1</span>]], </span>
<span id="cb120-2"><a href="evaluate-model-performance.html#cb120-2" aria-hidden="true"></a>               cryptodata_nested<span class="op">$</span>actuals_test[[<span class="dv">1</span>]], </span>
<span id="cb120-3"><a href="evaluate-model-performance.html#cb120-3" aria-hidden="true"></a>               <span class="dt">na.rm=</span>T)</span></code></pre></div>
<pre><code>## [1] 1.799863</code></pre>
<!-- [TODO - Here add note on using rmse function from hydroGOF package so we can use the na.rm=T argument, would otherwise get NA when a single value is NA. Also explain caveat of that.] -->
<div id="calculate-rmse" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Calculate RMSE</h3>
<p>Now make a function to get the RMSE metric for all models:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="evaluate-model-performance.html#cb122-1" aria-hidden="true"></a>evaluate_preds_rmse &lt;-<span class="st"> </span><span class="cf">function</span>(predictions, actuals){</span>
<span id="cb122-2"><a href="evaluate-model-performance.html#cb122-2" aria-hidden="true"></a></span>
<span id="cb122-3"><a href="evaluate-model-performance.html#cb122-3" aria-hidden="true"></a>  hydroGOF<span class="op">::</span><span class="kw">rmse</span>(predictions, actuals, <span class="dt">na.rm=</span>T)</span>
<span id="cb122-4"><a href="evaluate-model-performance.html#cb122-4" aria-hidden="true"></a></span>
<span id="cb122-5"><a href="evaluate-model-performance.html#cb122-5" aria-hidden="true"></a>}</span></code></pre></div>
<p>Now we can use map2() to use it to get the RMSE metric for both the test data and the holdout:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="evaluate-model-performance.html#cb123-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb123-2"><a href="evaluate-model-performance.html#cb123-2" aria-hidden="true"></a>                            <span class="dt">lm_rmse_test =</span> <span class="kw">unlist</span>(<span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb123-3"><a href="evaluate-model-performance.html#cb123-3" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(lm_test_predictions, actuals_test, evaluate_preds_rmse),</span>
<span id="cb123-4"><a href="evaluate-model-performance.html#cb123-4" aria-hidden="true"></a>                                                         <span class="ot">NA</span>)),</span>
<span id="cb123-5"><a href="evaluate-model-performance.html#cb123-5" aria-hidden="true"></a>                            <span class="dt">lm_rmse_holdout =</span> <span class="kw">unlist</span>(<span class="kw">map2</span>(lm_holdout_predictions, actuals_holdout, evaluate_preds_rmse)))</span></code></pre></div>
<!-- [TODO - Add explanation for ifelse() to add rmse based on test or holdout] -->
<p>Look at the results:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="evaluate-model-performance.html#cb124-1" aria-hidden="true"></a><span class="kw">select</span>(cryptodata_nested, lm_rmse_test, lm_rmse_holdout)</span></code></pre></div>
<pre><code>## [90m# A tibble: 245 x 4[39m
## [90m# Groups:   symbol, split [245][39m
##    symbol split lm_rmse_test lm_rmse_holdout
##    [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;dbl&gt;[39m[23m        [3m[90m&lt;dbl&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m
## [90m 1[39m BTG        1        1.80            0.987
## [90m 2[39m VET        1        1.04            2.00 
## [90m 3[39m IHF        1        0.742           6.61 
## [90m 4[39m DGB        1        1.54            1.33 
## [90m 5[39m LTC        1        0.844           1.17 
## [90m 6[39m NUT        1        1.70            0.380
## [90m 7[39m NEXO       1        2.02            1.87 
## [90m 8[39m XMR        1        0.726           1.68 
## [90m 9[39m VIB        1        1.03            5.01 
## [90m10[39m XDN        1        1.22            3.31 
## [90m# … with 235 more rows[39m</code></pre>
<p>Out of 245 groups, 81 had an equal or lower RMSE score for the holdout than the test set.</p>
</div>
<div id="calculate-r2" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Calculate R^2</h3>
<p>Now we can do the same for the R Squared metric:</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="evaluate-model-performance.html#cb126-1" aria-hidden="true"></a>evaluate_preds_rsq &lt;-<span class="st"> </span><span class="cf">function</span>(predictions, actuals){</span>
<span id="cb126-2"><a href="evaluate-model-performance.html#cb126-2" aria-hidden="true"></a></span>
<span id="cb126-3"><a href="evaluate-model-performance.html#cb126-3" aria-hidden="true"></a>  <span class="kw">postResample</span>(<span class="dt">pred =</span> predictions, <span class="dt">obs =</span> actuals)[[<span class="dv">2</span>]]</span>
<span id="cb126-4"><a href="evaluate-model-performance.html#cb126-4" aria-hidden="true"></a></span>
<span id="cb126-5"><a href="evaluate-model-performance.html#cb126-5" aria-hidden="true"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="evaluate-model-performance.html#cb127-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb127-2"><a href="evaluate-model-performance.html#cb127-2" aria-hidden="true"></a>                            <span class="dt">lm_rsq_test =</span> <span class="kw">unlist</span>(<span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb127-3"><a href="evaluate-model-performance.html#cb127-3" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(lm_test_predictions, actuals_test, evaluate_preds_rsq),</span>
<span id="cb127-4"><a href="evaluate-model-performance.html#cb127-4" aria-hidden="true"></a>                                                         <span class="ot">NA</span>)),</span>
<span id="cb127-5"><a href="evaluate-model-performance.html#cb127-5" aria-hidden="true"></a>                            <span class="dt">lm_rsq_holdout =</span> <span class="kw">unlist</span>(<span class="kw">map2</span>(lm_holdout_predictions, actuals_holdout, evaluate_preds_rsq)))</span></code></pre></div>
<p>Look at the results. Wrapping them in <code>print(n=500)</code> overwrites the behavior to only give a preview of the data so we can view the full results (up to 500 observations).</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="evaluate-model-performance.html#cb128-1" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">select</span>(cryptodata_nested, lm_rmse_test, lm_rmse_holdout, lm_rsq_test, lm_rsq_holdout), <span class="dt">n=</span><span class="dv">500</span>)</span></code></pre></div>
<pre><code>## [90m# A tibble: 245 x 6[39m
## [90m# Groups:   symbol, split [245][39m
##     symbol split lm_rmse_test lm_rmse_holdout lm_rsq_test lm_rsq_holdout
##     [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;dbl&gt;[39m[23m        [3m[90m&lt;dbl&gt;[39m[23m           [3m[90m&lt;dbl&gt;[39m[23m       [3m[90m&lt;dbl&gt;[39m[23m          [3m[90m&lt;dbl&gt;[39m[23m
## [90m  1[39m BTG        1      1.80            0.987     0.414           0.013[4m0[24m  
## [90m  2[39m VET        1      1.04            2.00      0.323           0.976   
## [90m  3[39m IHF        1      0.742           6.61      0.000[4m2[24m[4m7[24m[4m4[24m        0.007[4m8[24m[4m5[24m 
## [90m  4[39m DGB        1      1.54            1.33      0.011[4m1[24m          0.001[4m8[24m[4m0[24m 
## [90m  5[39m LTC        1      0.844           1.17      0.250           0.017[4m5[24m  
## [90m  6[39m NUT        1      1.70            0.380     0.008[4m1[24m[4m6[24m         0.136   
## [90m  7[39m NEXO       1      2.02            1.87      0.425           0.005[4m2[24m[4m0[24m 
## [90m  8[39m XMR        1      0.726           1.68      0.069[4m7[24m          0.000[4m4[24m[4m0[24m[4m3[24m
## [90m  9[39m VIB        1      1.03            5.01      0.327           0.537   
## [90m 10[39m XDN        1      1.22            3.31      0.567           0.089[4m5[24m  
## [90m 11[39m XNS        1      0.864          12.6       1               0.092[4m0[24m  
## [90m 12[39m REP        1      4.07            2.87      0.110           0.164   
## [90m 13[39m BAT        1      1.79            0.942     0.000[4m2[24m[4m8[24m[4m2[24m        0.006[4m2[24m[4m0[24m 
## [90m 14[39m BTC        1      0.475           0.886     0.189           0.025[4m3[24m  
## [90m 15[39m DCR        1      1.64            1.63      0.000[4m3[24m[4m3[24m[4m5[24m        0.011[4m9[24m  
## [90m 16[39m ENJ        1      2.13            1.32      0.023[4m1[24m          0.037[4m4[24m  
## [90m 17[39m XEM        1      2.95            1.50      0.000[4m0[24m[4m1[24m[4m0[24m2       0.002[4m5[24m[4m2[24m 
## [90m 18[39m HT         1      1.51            1.41      0.139           0.000[4m2[24m[4m2[24m[4m5[24m
## [90m 19[39m EOS        1      1.39            0.986     0.198           0.007[4m0[24m[4m6[24m 
## [90m 20[39m EDG        1      3.67            8.39      0.139           0.128   
## [90m 21[39m SRN        1      2.52            7.40      0.010[4m5[24m          0.406   
## [90m 22[39m CUR        1      0.014[4m9[24m          0.001[4m3[24m[4m6[24m   0.172           0.010[4m9[24m  
## [90m 23[39m XVG        1      1.40            0.958     0.044[4m5[24m          0.010[4m3[24m  
## [90m 24[39m NCT        1      1.18          [31mNaN[39m         0.908          [31mNA[39m       
## [90m 25[39m BRD        1      0.716           2.37      0.060[4m2[24m          0.060[4m7[24m  
## [90m 26[39m NCT        2      2.75          [31mNaN[39m         0.449          [31mNA[39m       
## [90m 27[39m IHF        2      1.59            6.61      0.003[4m5[24m[4m4[24m         0.007[4m8[24m[4m5[24m 
## [90m 28[39m CUR        2      0.008[4m8[24m[4m5[24m         0.001[4m3[24m[4m6[24m   0.945           0.010[4m9[24m  
## [90m 29[39m REP        2      2.50            2.87      0.008[4m7[24m[4m8[24m         0.164   
## [90m 30[39m VIB        2      2.65            5.01      0.221           0.537   
## [90m 31[39m XVG        2      2.09            0.958     0.002[4m5[24m[4m9[24m         0.010[4m3[24m  
## [90m 32[39m NUT        2      1.49            0.380     0.031[4m7[24m          0.136   
## [90m 33[39m BTG        2      1.11            0.987     0.004[4m4[24m[4m7[24m         0.013[4m0[24m  
## [90m 34[39m VET        2      1.53            2.00      0.128           0.976   
## [90m 35[39m ZEC        1      1.53            0.698     0.393           0.021[4m1[24m  
## [90m 36[39m XEM        2      1.62            1.50      0.000[4m9[24m[4m7[24m[4m0[24m        0.002[4m5[24m[4m2[24m 
## [90m 37[39m HT         2      0.785           1.41      0.104           0.000[4m2[24m[4m2[24m[4m5[24m
## [90m 38[39m XDN        2      0.698           3.31      0.019[4m1[24m          0.089[4m5[24m  
## [90m 39[39m XNS        2      1.61           12.6       0.826           0.092[4m0[24m  
## [90m 40[39m ENJ        2      1.43            1.32      0.007[4m6[24m[4m7[24m         0.037[4m4[24m  
## [90m 41[39m EOS        2      0.763           0.986     0.015[4m4[24m          0.007[4m0[24m[4m6[24m 
## [90m 42[39m NEXO       2      1.12            1.87      0.228           0.005[4m2[24m[4m0[24m 
## [90m 43[39m DGB        2      1.10            1.33      0.051[4m8[24m          0.001[4m8[24m[4m0[24m 
## [90m 44[39m XMR        2      0.859           1.68      0.050[4m5[24m          0.000[4m4[24m[4m0[24m[4m3[24m
## [90m 45[39m EDG        2     24.1             8.39      0.024[4m2[24m          0.128   
## [90m 46[39m LTC        2      0.842           1.17      0.014[4m9[24m          0.017[4m5[24m  
## [90m 47[39m BTC        2      0.518           0.886     0.002[4m2[24m[4m6[24m         0.025[4m3[24m  
## [90m 48[39m SRN        2      3.73            7.40      0.179           0.406   
## [90m 49[39m BAT        2      1.01            0.942     0.018[4m7[24m          0.006[4m2[24m[4m0[24m 
## [90m 50[39m DCR        2      1.15            1.63      0.001[4m6[24m[4m0[24m         0.011[4m9[24m  
## [90m 51[39m BRD        2    [31mNaN[39m               2.37     [31mNA[39m               0.060[4m7[24m  
## [90m 52[39m NCT        3      3.31          [31mNaN[39m         0.080[4m5[24m         [31mNA[39m       
## [90m 53[39m IHF        3      0.341           6.61      0.477           0.007[4m8[24m[4m5[24m 
## [90m 54[39m CUR        3      9.62            0.001[4m3[24m[4m6[24m   0.074[4m2[24m          0.010[4m9[24m  
## [90m 55[39m REP        3      0.937           2.87      0.063[4m6[24m          0.164   
## [90m 56[39m CBC        1      0.589           3.54      0.606           0.019[4m6[24m  
## [90m 57[39m BNT        1      1.54            1.83      0.542           0.002[4m8[24m[4m0[24m 
## [90m 58[39m MANA       1      0.878           1.39      0.030[4m7[24m          0.053[4m7[24m  
## [90m 59[39m OAX        1      0.907           9.24      0.422           0.147   
## [90m 60[39m ZRX        1      1.09            0.708     0.535           0.025[4m2[24m  
## [90m 61[39m TRX        1      1.11            1.05      0.008[4m6[24m[4m6[24m         0.020[4m9[24m  
## [90m 62[39m BSV        1      0.632           1.23      0.005[4m6[24m[4m2[24m         0.035[4m1[24m  
## [90m 63[39m SUB        1      2.99          [31mNaN[39m         0.241          [31mNA[39m       
## [90m 64[39m BTT        1      0.959           0.768     0.162           0.070[4m3[24m  
## [90m 65[39m SMART      1      1.89            0.912     0.015[4m7[24m          0.084[4m7[24m  
## [90m 66[39m ETP        1      1.06            0.915     0.320           0.000[4m3[24m[4m6[24m[4m9[24m
## [90m 67[39m CRO        1      0.353           1.32      0.384           0.184   
## [90m 68[39m VIB        3      5.67            5.01      0.983           0.537   
## [90m 69[39m ELF        1      0.197           0.744     0.252           0.025[4m0[24m  
## [90m 70[39m XVG        3      2.34            0.958     0.086[4m5[24m          0.010[4m3[24m  
## [90m 71[39m NUT        3      0.456           0.380     0.247           0.136   
## [90m 72[39m BTG        3      0.473           0.987     0.061[4m9[24m          0.013[4m0[24m  
## [90m 73[39m VET        3      1.24            2.00      0.152           0.976   
## [90m 74[39m XEM        3      1.38            1.50      0.526           0.002[4m5[24m[4m2[24m 
## [90m 75[39m SRN        3      4.98            7.40      0.106           0.406   
## [90m 76[39m HT         3      0.414           1.41      0.064[4m1[24m          0.000[4m2[24m[4m2[24m[4m5[24m
## [90m 77[39m EOS        3      0.600           0.986     0.069[4m5[24m          0.007[4m0[24m[4m6[24m 
## [90m 78[39m ENJ        3      4.96            1.32      0.070[4m9[24m          0.037[4m4[24m  
## [90m 79[39m XDN        3      0.253           3.31      0.019[4m8[24m          0.089[4m5[24m  
## [90m 80[39m NEXO       3      1.58            1.87      0.193           0.005[4m2[24m[4m0[24m 
## [90m 81[39m XMR        3      1.24            1.68      0.429           0.000[4m4[24m[4m0[24m[4m3[24m
## [90m 82[39m DGB        3      1.44            1.33      0.594           0.001[4m8[24m[4m0[24m 
## [90m 83[39m BTC        3      0.442           0.886     0.002[4m0[24m[4m9[24m         0.025[4m3[24m  
## [90m 84[39m EDG        3     29.0             8.39      0.067[4m1[24m          0.128   
## [90m 85[39m LTC        3      0.615           1.17      0.006[4m8[24m[4m9[24m         0.017[4m5[24m  
## [90m 86[39m BAT        3      1.67            0.942     0.027[4m0[24m          0.006[4m2[24m[4m0[24m 
## [90m 87[39m DCR        3      0.787           1.63      0.020[4m0[24m          0.011[4m9[24m  
## [90m 88[39m ZEC        2      0.739           0.698     0.060[4m2[24m          0.021[4m1[24m  
## [90m 89[39m SUB        2    [31mNaN[39m             [31mNaN[39m        [31mNA[39m              [31mNA[39m       
## [90m 90[39m CRO        2    [31mNaN[39m               1.32     [31mNA[39m               0.184   
## [90m 91[39m BNT        2      3.41            1.83      0.042[4m6[24m          0.002[4m8[24m[4m0[24m 
## [90m 92[39m OAX        2     21.8             9.24      0.040[4m4[24m          0.147   
## [90m 93[39m TRX        2      0.551           1.05      0.030[4m7[24m          0.020[4m9[24m  
## [90m 94[39m BSV        2      2.29            1.23      0.173           0.035[4m1[24m  
## [90m 95[39m SMART      2      0.974           0.912     0.188           0.084[4m7[24m  
## [90m 96[39m ETP        2      1.09            0.915     0.022[4m2[24m          0.000[4m3[24m[4m6[24m[4m9[24m
## [90m 97[39m MANA       2      2.39            1.39      0.320           0.053[4m7[24m  
## [90m 98[39m BTT        2      1.37            0.768     0.436           0.070[4m3[24m  
## [90m 99[39m ZRX        2      1.19            0.708     0.045[4m4[24m          0.025[4m2[24m  
## [90m100[39m CBC        2      7.87            3.54      0.054[4m6[24m          0.019[4m6[24m  
## [90m101[39m ELF        2    [31mNaN[39m               0.744    [31mNA[39m               0.025[4m0[24m  
## [90m102[39m ZEC        3      1.26            0.698     0.069[4m5[24m          0.021[4m1[24m  
## [90m103[39m CHZ        1      1.41            1.72      0.022[4m8[24m          0.019[4m8[24m  
## [90m104[39m ADA        1      1.77            1.18      0.007[4m4[24m[4m0[24m         0.046[4m0[24m  
## [90m105[39m ARDR       1      1.36            0.826     0.008[4m6[24m[4m8[24m         0.000[4m7[24m[4m1[24m[4m0[24m
## [90m106[39m SOLO       1      0.997           5.38      0.072[4m9[24m          0.011[4m1[24m  
## [90m107[39m ZAP        1      4.02            5.12      0.113           0.008[4m1[24m[4m6[24m 
## [90m108[39m IPX        1      2.88          [31mNaN[39m         0.008[4m2[24m[4m3[24m        [31mNA[39m       
## [90m109[39m KNC        1      2.36            0.847     0.018[4m3[24m          0.006[4m4[24m[4m1[24m 
## [90m110[39m XPR        1      0.554           3.59      0.165           0.274   
## [90m111[39m KMD        1      0.697           1.06      0.006[4m6[24m[4m5[24m         0.077[4m7[24m  
## [90m112[39m XVG        4      0.448           0.958     0.461           0.010[4m3[24m  
## [90m113[39m BRD        3      4.12            2.37      0.243           0.060[4m7[24m  
## [90m114[39m VIB        4      3.69            5.01     [31mNA[39m               0.537   
## [90m115[39m NUT        4      3.17            0.380     0.010[4m0[24m          0.136   
## [90m116[39m VET        4      1.17            2.00      0.004[4m1[24m[4m0[24m         0.976   
## [90m117[39m BTG        4      0.185           0.987     1               0.013[4m0[24m  
## [90m118[39m XNS        3      2.17           12.6       0.114           0.092[4m0[24m  
## [90m119[39m SRN        4     13.5             7.40      0.005[4m1[24m[4m0[24m         0.406   
## [90m120[39m XEM        4      1.22            1.50      0.000[4m2[24m[4m4[24m[4m3[24m        0.002[4m5[24m[4m2[24m 
## [90m121[39m HT         4      0.923           1.41      0.482           0.000[4m2[24m[4m2[24m[4m5[24m
## [90m122[39m EOS        4      0.388           0.986     0.000[4m4[24m[4m2[24m[4m0[24m        0.007[4m0[24m[4m6[24m 
## [90m123[39m XDN        4      4.14            3.31      0.275           0.089[4m5[24m  
## [90m124[39m BNT        3      3.39            1.83     [31mNA[39m               0.002[4m8[24m[4m0[24m 
## [90m125[39m ENJ        4      8.67            1.32      0.294           0.037[4m4[24m  
## [90m126[39m SUB        3     29.5           [31mNaN[39m         0.278          [31mNA[39m       
## [90m127[39m OAX        3      0.249           9.24      0.028[4m5[24m          0.147   
## [90m128[39m CRO        3    [31mNaN[39m               1.32     [31mNA[39m               0.184   
## [90m129[39m XMR        4      0.936           1.68      0.246           0.000[4m4[24m[4m0[24m[4m3[24m
## [90m130[39m TRX        3      0.785           1.05      0.020[4m6[24m          0.020[4m9[24m  
## [90m131[39m BTC        4      0.445           0.886     0.003[4m2[24m[4m0[24m         0.025[4m3[24m  
## [90m132[39m EDG        4     33.3             8.39      0.133           0.128   
## [90m133[39m DGB        4      2.46            1.33      0.000[4m0[24m[4m7[24m[4m9[24m4       0.001[4m8[24m[4m0[24m 
## [90m134[39m LTC        4      1.15            1.17      0.029[4m6[24m          0.017[4m5[24m  
## [90m135[39m BAT        4      2.61            0.942     0.105           0.006[4m2[24m[4m0[24m 
## [90m136[39m NEXO       4      2.38            1.87      0.069[4m9[24m          0.005[4m2[24m[4m0[24m 
## [90m137[39m MANA       3      1.06            1.39      0.018[4m9[24m          0.053[4m7[24m  
## [90m138[39m ETP        3      0.638           0.915     0.003[4m5[24m[4m2[24m         0.000[4m3[24m[4m6[24m[4m9[24m
## [90m139[39m BSV        3      0.731           1.23      0.095[4m9[24m          0.035[4m1[24m  
## [90m140[39m BTT        3      1.18            0.768     0.001[4m2[24m[4m3[24m         0.070[4m3[24m  
## [90m141[39m DCR        4      1.60            1.63      0.011[4m4[24m          0.011[4m9[24m  
## [90m142[39m SMART      3      1.60            0.912     0.021[4m6[24m          0.084[4m7[24m  
## [90m143[39m ZRX        3      1.03            0.708     0.031[4m2[24m          0.025[4m2[24m  
## [90m144[39m CBC        3      2.28            3.54      0.045[4m0[24m          0.019[4m6[24m  
## [90m145[39m ZAP        2      4.31            5.12      0.082[4m4[24m          0.008[4m1[24m[4m6[24m 
## [90m146[39m ELF        3      0.640           0.744     0.994           0.025[4m0[24m  
## [90m147[39m CUR        4      0.045[4m6[24m          0.001[4m3[24m[4m6[24m   0.527           0.010[4m9[24m  
## [90m148[39m KNC        2      1.16            0.847     0.010[4m9[24m          0.006[4m4[24m[4m1[24m 
## [90m149[39m IPX        2    [31mNaN[39m             [31mNaN[39m        [31mNA[39m              [31mNA[39m       
## [90m150[39m ARDR       2      3.53            0.826     0.011[4m1[24m          0.000[4m7[24m[4m1[24m[4m0[24m
## [90m151[39m CHZ        2      0.996           1.72      0.050[4m7[24m          0.019[4m8[24m  
## [90m152[39m SOLO       2      6.52            5.38      0.112           0.011[4m1[24m  
## [90m153[39m XPR        2      0.972           3.59      0.012[4m9[24m          0.274   
## [90m154[39m KMD        2      0.575           1.06      0.191           0.077[4m7[24m  
## [90m155[39m ADA        2      1.50            1.18      0.002[4m0[24m[4m5[24m         0.046[4m0[24m  
## [90m156[39m IHF        4      0.425           6.61      0.019[4m4[24m          0.007[4m8[24m[4m5[24m 
## [90m157[39m NCT        4      0.633         [31mNaN[39m         0.496          [31mNA[39m       
## [90m158[39m YFI        1      2.61            1.70      0.357           0.451   
## [90m159[39m REP        4      1.06            2.87      0.014[4m0[24m          0.164   
## [90m160[39m BRD        4      0.732           2.37      0.078[4m4[24m          0.060[4m7[24m  
## [90m161[39m ZAP        3      2.15            5.12      0.754           0.008[4m1[24m[4m6[24m 
## [90m162[39m KNC        3      0.487           0.847     0.281           0.006[4m4[24m[4m1[24m 
## [90m163[39m XNS        4      4.79           12.6       0.302           0.092[4m0[24m  
## [90m164[39m YFI        2      3.10            1.70      0.037[4m9[24m          0.451   
## [90m165[39m ARDR       3      7.78            0.826     0.434           0.000[4m7[24m[4m1[24m[4m0[24m
## [90m166[39m CHZ        3      0.481           1.72      0.023[4m3[24m          0.019[4m8[24m  
## [90m167[39m SOLO       3      1.50            5.38      0.001[4m1[24m[4m5[24m         0.011[4m1[24m  
## [90m168[39m XPR        3      0.875           3.59      0.016[4m5[24m          0.274   
## [90m169[39m ADA        3      0.668           1.18      0.402           0.046[4m0[24m  
## [90m170[39m OAX        4      2.05            9.24      0.646           0.147   
## [90m171[39m TRX        4      0.422           1.05      0.068[4m3[24m          0.020[4m9[24m  
## [90m172[39m KMD        3      1.85            1.06      0.002[4m0[24m[4m0[24m         0.077[4m7[24m  
## [90m173[39m MANA       4      1.50            1.39      0.002[4m6[24m[4m5[24m         0.053[4m7[24m  
## [90m174[39m SMART      4      1.80            0.912     0.041[4m5[24m          0.084[4m7[24m  
## [90m175[39m IPX        3      0.826         [31mNaN[39m         0.030[4m6[24m         [31mNA[39m       
## [90m176[39m ETP        4      1.18            0.915     0.102           0.000[4m3[24m[4m6[24m[4m9[24m
## [90m177[39m SUB        4      3.16          [31mNaN[39m         0.206          [31mNA[39m       
## [90m178[39m BTT        4      0.798           0.768     0.003[4m5[24m[4m6[24m         0.070[4m3[24m  
## [90m179[39m ZRX        4      0.673           0.708     0.035[4m6[24m          0.025[4m2[24m  
## [90m180[39m BNT        4      1.23            1.83      0.745           0.002[4m8[24m[4m0[24m 
## [90m181[39m CBC        4      3.31            3.54      0.077[4m0[24m          0.019[4m6[24m  
## [90m182[39m CRO        4      0.983           1.32      0.100           0.184   
## [90m183[39m BSV        4      1.10            1.23      0.005[4m0[24m[4m1[24m         0.035[4m1[24m  
## [90m184[39m VET        5     [31mNA[39m               2.00     [31mNA[39m               0.976   
## [90m185[39m CUR        5     [31mNA[39m               0.001[4m3[24m[4m6[24m  [31mNA[39m               0.010[4m9[24m  
## [90m186[39m SRN        5     [31mNA[39m               7.40     [31mNA[39m               0.406   
## [90m187[39m XVG        5     [31mNA[39m               0.958    [31mNA[39m               0.010[4m3[24m  
## [90m188[39m NUT        5     [31mNA[39m               0.380    [31mNA[39m               0.136   
## [90m189[39m ELF        4      0.880           0.744     0.002[4m1[24m[4m7[24m         0.025[4m0[24m  
## [90m190[39m IHF        5     [31mNA[39m               6.61     [31mNA[39m               0.007[4m8[24m[4m5[24m 
## [90m191[39m VIB        5     [31mNA[39m               5.01     [31mNA[39m               0.537   
## [90m192[39m YFI        3      2.35            1.70      0.041[4m9[24m          0.451   
## [90m193[39m EOS        5     [31mNA[39m               0.986    [31mNA[39m               0.007[4m0[24m[4m6[24m 
## [90m194[39m ENJ        5     [31mNA[39m               1.32     [31mNA[39m               0.037[4m4[24m  
## [90m195[39m XDN        5     [31mNA[39m               3.31     [31mNA[39m               0.089[4m5[24m  
## [90m196[39m XMR        5     [31mNA[39m               1.68     [31mNA[39m               0.000[4m4[24m[4m0[24m[4m3[24m
## [90m197[39m EDG        5     [31mNA[39m               8.39     [31mNA[39m               0.128   
## [90m198[39m BTC        5     [31mNA[39m               0.886    [31mNA[39m               0.025[4m3[24m  
## [90m199[39m DGB        5     [31mNA[39m               1.33     [31mNA[39m               0.001[4m8[24m[4m0[24m 
## [90m200[39m LTC        5     [31mNA[39m               1.17     [31mNA[39m               0.017[4m5[24m  
## [90m201[39m HT         5     [31mNA[39m               1.41     [31mNA[39m               0.000[4m2[24m[4m2[24m[4m5[24m
## [90m202[39m NEXO       5     [31mNA[39m               1.87     [31mNA[39m               0.005[4m2[24m[4m0[24m 
## [90m203[39m BTG        5     [31mNA[39m               0.987    [31mNA[39m               0.013[4m0[24m  
## [90m204[39m BAT        5     [31mNA[39m               0.942    [31mNA[39m               0.006[4m2[24m[4m0[24m 
## [90m205[39m DCR        5     [31mNA[39m               1.63     [31mNA[39m               0.011[4m9[24m  
## [90m206[39m XEM        5     [31mNA[39m               1.50     [31mNA[39m               0.002[4m5[24m[4m2[24m 
## [90m207[39m KNC        4      0.216           0.847     1               0.006[4m4[24m[4m1[24m 
## [90m208[39m SOLO       4      3.67            5.38      0.015[4m7[24m          0.011[4m1[24m  
## [90m209[39m XPR        4      1.73            3.59      0.608           0.274   
## [90m210[39m CHZ        4      0.599           1.72      0.399           0.019[4m8[24m  
## [90m211[39m ADA        4      0.964           1.18      0.160           0.046[4m0[24m  
## [90m212[39m ARDR       4      3.27            0.826     0.095[4m1[24m          0.000[4m7[24m[4m1[24m[4m0[24m
## [90m213[39m ZAP        4      0.496           5.12      0.230           0.008[4m1[24m[4m6[24m 
## [90m214[39m NCT        5     [31mNA[39m             [31mNaN[39m        [31mNA[39m              [31mNA[39m       
## [90m215[39m KMD        4      3.19            1.06      0.118           0.077[4m7[24m  
## [90m216[39m ZEC        4      1.10            0.698     0.007[4m3[24m[4m6[24m         0.021[4m1[24m  
## [90m217[39m IPX        4      2.86          [31mNaN[39m         0.040[4m7[24m         [31mNA[39m       
## [90m218[39m REP        5     [31mNA[39m               2.87     [31mNA[39m               0.164   
## [90m219[39m XNS        5     [31mNA[39m              12.6      [31mNA[39m               0.092[4m0[24m  
## [90m220[39m BRD        5     [31mNA[39m               2.37     [31mNA[39m               0.060[4m7[24m  
## [90m221[39m SUB        5     [31mNA[39m             [31mNaN[39m        [31mNA[39m              [31mNA[39m       
## [90m222[39m YFI        4      2.55            1.70      0.427           0.451   
## [90m223[39m BTT        5     [31mNA[39m               0.768    [31mNA[39m               0.070[4m3[24m  
## [90m224[39m ETP        5     [31mNA[39m               0.915    [31mNA[39m               0.000[4m3[24m[4m6[24m[4m9[24m
## [90m225[39m ZRX        5     [31mNA[39m               0.708    [31mNA[39m               0.025[4m2[24m  
## [90m226[39m SMART      5     [31mNA[39m               0.912    [31mNA[39m               0.084[4m7[24m  
## [90m227[39m CBC        5     [31mNA[39m               3.54     [31mNA[39m               0.019[4m6[24m  
## [90m228[39m BSV        5     [31mNA[39m               1.23     [31mNA[39m               0.035[4m1[24m  
## [90m229[39m MANA       5     [31mNA[39m               1.39     [31mNA[39m               0.053[4m7[24m  
## [90m230[39m TRX        5     [31mNA[39m               1.05     [31mNA[39m               0.020[4m9[24m  
## [90m231[39m OAX        5     [31mNA[39m               9.24     [31mNA[39m               0.147   
## [90m232[39m BNT        5     [31mNA[39m               1.83     [31mNA[39m               0.002[4m8[24m[4m0[24m 
## [90m233[39m CRO        5     [31mNA[39m               1.32     [31mNA[39m               0.184   
## [90m234[39m ELF        5     [31mNA[39m               0.744    [31mNA[39m               0.025[4m0[24m  
## [90m235[39m IPX        5     [31mNA[39m             [31mNaN[39m        [31mNA[39m              [31mNA[39m       
## [90m236[39m CHZ        5     [31mNA[39m               1.72     [31mNA[39m               0.019[4m8[24m  
## [90m237[39m XPR        5     [31mNA[39m               3.59     [31mNA[39m               0.274   
## [90m238[39m SOLO       5     [31mNA[39m               5.38     [31mNA[39m               0.011[4m1[24m  
## [90m239[39m ADA        5     [31mNA[39m               1.18     [31mNA[39m               0.046[4m0[24m  
## [90m240[39m ARDR       5     [31mNA[39m               0.826    [31mNA[39m               0.000[4m7[24m[4m1[24m[4m0[24m
## [90m241[39m KNC        5     [31mNA[39m               0.847    [31mNA[39m               0.006[4m4[24m[4m1[24m 
## [90m242[39m ZAP        5     [31mNA[39m               5.12     [31mNA[39m               0.008[4m1[24m[4m6[24m 
## [90m243[39m KMD        5     [31mNA[39m               1.06     [31mNA[39m               0.077[4m7[24m  
## [90m244[39m ZEC        5     [31mNA[39m               0.698    [31mNA[39m               0.021[4m1[24m  
## [90m245[39m YFI        5     [31mNA[39m               1.70     [31mNA[39m               0.451</code></pre>
<!-- WORKING UP TO THIS POINT ON 11/2 -->
</div>
</div>
<div id="adjust-prices---all-models" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Adjust Prices - All Models</h2>
<!-- [TODO - OR IS IT BETTER TO DO ALL AT ONCE ABOVE?] -->
<div id="add-last-price-1" class="section level3" number="7.4.1">
<h3><span class="header-section-number">7.4.1</span> Add Last Price</h3>
<p>And now we can do the same for all the other models</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="evaluate-model-performance.html#cb130-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb130-2"><a href="evaluate-model-performance.html#cb130-2" aria-hidden="true"></a>                            <span class="dt">xgb_test_predictions =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb130-3"><a href="evaluate-model-performance.html#cb130-3" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(train_data, xgb_test_predictions, last_train_price),</span>
<span id="cb130-4"><a href="evaluate-model-performance.html#cb130-4" aria-hidden="true"></a>                                                         <span class="ot">NA</span>),</span>
<span id="cb130-5"><a href="evaluate-model-performance.html#cb130-5" aria-hidden="true"></a>                            <span class="dt">xgbTree_test_predictions =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb130-6"><a href="evaluate-model-performance.html#cb130-6" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(train_data, xgbTree_test_predictions, last_train_price),</span>
<span id="cb130-7"><a href="evaluate-model-performance.html#cb130-7" aria-hidden="true"></a>                                                         <span class="ot">NA</span>),</span>
<span id="cb130-8"><a href="evaluate-model-performance.html#cb130-8" aria-hidden="true"></a>                            <span class="dt">nnet_test_predictions =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb130-9"><a href="evaluate-model-performance.html#cb130-9" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(train_data, nnet_test_predictions, last_train_price),</span>
<span id="cb130-10"><a href="evaluate-model-performance.html#cb130-10" aria-hidden="true"></a>                                                         <span class="ot">NA</span>))</span></code></pre></div>
<div id="holdout-2" class="section level5" number="7.4.1.0.1">
<h5><span class="header-section-number">7.4.1.0.1</span> Holdout</h5>
<p>(REMEMBER holdout step for all to get price from 5th train split first)</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="evaluate-model-performance.html#cb131-1" aria-hidden="true"></a>cryptodata_nested_holdout &lt;-<span class="st"> </span><span class="kw">mutate</span>(<span class="kw">filter</span>(cryptodata_nested, split <span class="op">==</span><span class="st"> </span><span class="dv">5</span>),</span>
<span id="cb131-2"><a href="evaluate-model-performance.html#cb131-2" aria-hidden="true"></a>                                    <span class="dt">xgb_holdout_predictions =</span> <span class="kw">map2</span>(train_data, xgb_holdout_predictions, last_train_price),</span>
<span id="cb131-3"><a href="evaluate-model-performance.html#cb131-3" aria-hidden="true"></a>                                    <span class="dt">xgbTree_holdout_predictions =</span> <span class="kw">map2</span>(train_data, xgbTree_holdout_predictions, last_train_price),</span>
<span id="cb131-4"><a href="evaluate-model-performance.html#cb131-4" aria-hidden="true"></a>                                    <span class="dt">nnet_holdout_predictions =</span> <span class="kw">map2</span>(train_data, nnet_holdout_predictions, last_train_price))</span></code></pre></div>
<p>Join the holdout data to all rows based on the cryptocurrency symbol alone:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="evaluate-model-performance.html#cb132-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">left_join</span>(cryptodata_nested, </span>
<span id="cb132-2"><a href="evaluate-model-performance.html#cb132-2" aria-hidden="true"></a>                               <span class="kw">select</span>(cryptodata_nested_holdout, symbol, </span>
<span id="cb132-3"><a href="evaluate-model-performance.html#cb132-3" aria-hidden="true"></a>                                      xgb_holdout_predictions, xgbTree_holdout_predictions, nnet_holdout_predictions),</span>
<span id="cb132-4"><a href="evaluate-model-performance.html#cb132-4" aria-hidden="true"></a>                               <span class="dt">by=</span><span class="st">&#39;symbol&#39;</span>)</span>
<span id="cb132-5"><a href="evaluate-model-performance.html#cb132-5" aria-hidden="true"></a><span class="co"># Remove unwanted columns</span></span>
<span id="cb132-6"><a href="evaluate-model-performance.html#cb132-6" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">select</span>(cryptodata_nested, <span class="op">-</span>xgb_holdout_predictions.x, </span>
<span id="cb132-7"><a href="evaluate-model-performance.html#cb132-7" aria-hidden="true"></a>                            <span class="op">-</span>xgbTree_holdout_predictions.x, <span class="op">-</span>nnet_holdout_predictions.x, <span class="op">-</span>split.y)</span>
<span id="cb132-8"><a href="evaluate-model-performance.html#cb132-8" aria-hidden="true"></a><span class="co"># Rename the columns kept</span></span>
<span id="cb132-9"><a href="evaluate-model-performance.html#cb132-9" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">rename</span>(cryptodata_nested, </span>
<span id="cb132-10"><a href="evaluate-model-performance.html#cb132-10" aria-hidden="true"></a>                            <span class="dt">xgb_holdout_predictions =</span> <span class="st">&#39;xgb_holdout_predictions.y&#39;</span>,</span>
<span id="cb132-11"><a href="evaluate-model-performance.html#cb132-11" aria-hidden="true"></a>                            <span class="dt">xgbTree_holdout_predictions =</span> <span class="st">&#39;xgbTree_holdout_predictions.y&#39;</span>,</span>
<span id="cb132-12"><a href="evaluate-model-performance.html#cb132-12" aria-hidden="true"></a>                            <span class="dt">nnet_holdout_predictions =</span> <span class="st">&#39;nnet_holdout_predictions.y&#39;</span>,</span>
<span id="cb132-13"><a href="evaluate-model-performance.html#cb132-13" aria-hidden="true"></a>                            <span class="dt">split =</span> <span class="st">&#39;split.x&#39;</span>)</span>
<span id="cb132-14"><a href="evaluate-model-performance.html#cb132-14" aria-hidden="true"></a><span class="co"># Reset the correct grouping structure</span></span>
<span id="cb132-15"><a href="evaluate-model-performance.html#cb132-15" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">group_by</span>(cryptodata_nested, symbol, split)</span></code></pre></div>
</div>
</div>
<div id="convert-to-change" class="section level3" number="7.4.2">
<h3><span class="header-section-number">7.4.2</span> Convert to % Change</h3>
<p>Overwrite the old predictions with the new predictions adjusted as a percentage now:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="evaluate-model-performance.html#cb133-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb133-2"><a href="evaluate-model-performance.html#cb133-2" aria-hidden="true"></a>                            <span class="dt">xgb_test_predictions =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb133-3"><a href="evaluate-model-performance.html#cb133-3" aria-hidden="true"></a>                                                         <span class="kw">map</span>(xgb_test_predictions, standardize_perc_change),</span>
<span id="cb133-4"><a href="evaluate-model-performance.html#cb133-4" aria-hidden="true"></a>                                                         <span class="ot">NA</span>),</span>
<span id="cb133-5"><a href="evaluate-model-performance.html#cb133-5" aria-hidden="true"></a>                            <span class="co"># Holdout for all splits</span></span>
<span id="cb133-6"><a href="evaluate-model-performance.html#cb133-6" aria-hidden="true"></a>                            <span class="dt">xgb_holdout_predictions =</span> <span class="kw">map</span>(xgb_holdout_predictions, standardize_perc_change),</span>
<span id="cb133-7"><a href="evaluate-model-performance.html#cb133-7" aria-hidden="true"></a>                            <span class="co"># xgbTree</span></span>
<span id="cb133-8"><a href="evaluate-model-performance.html#cb133-8" aria-hidden="true"></a>                            <span class="dt">xgbTree_test_predictions =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb133-9"><a href="evaluate-model-performance.html#cb133-9" aria-hidden="true"></a>                                                         <span class="kw">map</span>(xgbTree_test_predictions, standardize_perc_change),</span>
<span id="cb133-10"><a href="evaluate-model-performance.html#cb133-10" aria-hidden="true"></a>                                                         <span class="ot">NA</span>),</span>
<span id="cb133-11"><a href="evaluate-model-performance.html#cb133-11" aria-hidden="true"></a>                            <span class="co"># Holdout for all splits</span></span>
<span id="cb133-12"><a href="evaluate-model-performance.html#cb133-12" aria-hidden="true"></a>                            <span class="dt">xgbTree_holdout_predictions =</span> <span class="kw">map</span>(xgbTree_holdout_predictions, standardize_perc_change),</span>
<span id="cb133-13"><a href="evaluate-model-performance.html#cb133-13" aria-hidden="true"></a>                            <span class="co"># nnet</span></span>
<span id="cb133-14"><a href="evaluate-model-performance.html#cb133-14" aria-hidden="true"></a>                            <span class="dt">nnet_test_predictions =</span> <span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb133-15"><a href="evaluate-model-performance.html#cb133-15" aria-hidden="true"></a>                                                         <span class="kw">map</span>(nnet_test_predictions, standardize_perc_change),</span>
<span id="cb133-16"><a href="evaluate-model-performance.html#cb133-16" aria-hidden="true"></a>                                                         <span class="ot">NA</span>),</span>
<span id="cb133-17"><a href="evaluate-model-performance.html#cb133-17" aria-hidden="true"></a>                            <span class="co"># Holdout for all splits</span></span>
<span id="cb133-18"><a href="evaluate-model-performance.html#cb133-18" aria-hidden="true"></a>                            <span class="dt">nnet_holdout_predictions =</span> <span class="kw">map</span>(nnet_holdout_predictions, standardize_perc_change))</span></code></pre></div>
</div>
<div id="add-metrics" class="section level3" number="7.4.3">
<h3><span class="header-section-number">7.4.3</span> Add Metrics</h3>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="evaluate-model-performance.html#cb134-1" aria-hidden="true"></a>cryptodata_nested &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_nested,</span>
<span id="cb134-2"><a href="evaluate-model-performance.html#cb134-2" aria-hidden="true"></a>                            <span class="co"># XGBoost - RMSE - Test</span></span>
<span id="cb134-3"><a href="evaluate-model-performance.html#cb134-3" aria-hidden="true"></a>                            <span class="dt">xgb_rmse_test =</span> <span class="kw">unlist</span>(<span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb134-4"><a href="evaluate-model-performance.html#cb134-4" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(xgb_test_predictions, actuals_test, evaluate_preds_rmse),</span>
<span id="cb134-5"><a href="evaluate-model-performance.html#cb134-5" aria-hidden="true"></a>                                                         <span class="ot">NA</span>)),</span>
<span id="cb134-6"><a href="evaluate-model-performance.html#cb134-6" aria-hidden="true"></a>                            <span class="co"># And holdout:</span></span>
<span id="cb134-7"><a href="evaluate-model-performance.html#cb134-7" aria-hidden="true"></a>                            <span class="dt">xgb_rmse_holdout =</span> <span class="kw">unlist</span>(<span class="kw">map2</span>(xgb_holdout_predictions, actuals_holdout ,evaluate_preds_rmse)),</span>
<span id="cb134-8"><a href="evaluate-model-performance.html#cb134-8" aria-hidden="true"></a>                            <span class="co"># XGBoost - R^2 - Test</span></span>
<span id="cb134-9"><a href="evaluate-model-performance.html#cb134-9" aria-hidden="true"></a>                            <span class="dt">xgb_rsq_test =</span> <span class="kw">unlist</span>(<span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb134-10"><a href="evaluate-model-performance.html#cb134-10" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(xgb_test_predictions, actuals_test, evaluate_preds_rsq),</span>
<span id="cb134-11"><a href="evaluate-model-performance.html#cb134-11" aria-hidden="true"></a>                                                         <span class="ot">NA</span>)),</span>
<span id="cb134-12"><a href="evaluate-model-performance.html#cb134-12" aria-hidden="true"></a>                            <span class="co"># And holdout:</span></span>
<span id="cb134-13"><a href="evaluate-model-performance.html#cb134-13" aria-hidden="true"></a>                            <span class="dt">xgb_rsq_holdout =</span> <span class="kw">map2</span>(xgb_holdout_predictions, actuals_holdout, evaluate_preds_rsq),</span>
<span id="cb134-14"><a href="evaluate-model-performance.html#cb134-14" aria-hidden="true"></a>                            <span class="co"># XGBoost Trees - RMSE - Test</span></span>
<span id="cb134-15"><a href="evaluate-model-performance.html#cb134-15" aria-hidden="true"></a>                            <span class="dt">xgbTree_rmse_test =</span> <span class="kw">unlist</span>(<span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb134-16"><a href="evaluate-model-performance.html#cb134-16" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(xgbTree_test_predictions, actuals_test, evaluate_preds_rmse),</span>
<span id="cb134-17"><a href="evaluate-model-performance.html#cb134-17" aria-hidden="true"></a>                                                         <span class="ot">NA</span>)),</span>
<span id="cb134-18"><a href="evaluate-model-performance.html#cb134-18" aria-hidden="true"></a>                            <span class="co"># And holdout:</span></span>
<span id="cb134-19"><a href="evaluate-model-performance.html#cb134-19" aria-hidden="true"></a>                            <span class="dt">xgbTree_rmse_holdout =</span> <span class="kw">unlist</span>(<span class="kw">map2</span>(xgbTree_holdout_predictions, actuals_holdout, evaluate_preds_rmse)),</span>
<span id="cb134-20"><a href="evaluate-model-performance.html#cb134-20" aria-hidden="true"></a>                            <span class="co"># XGBoost Trees - R^2 - Test</span></span>
<span id="cb134-21"><a href="evaluate-model-performance.html#cb134-21" aria-hidden="true"></a>                            <span class="dt">xgbTree_rsq_test =</span> <span class="kw">unlist</span>(<span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb134-22"><a href="evaluate-model-performance.html#cb134-22" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(xgbTree_test_predictions, actuals_test, evaluate_preds_rsq),</span>
<span id="cb134-23"><a href="evaluate-model-performance.html#cb134-23" aria-hidden="true"></a>                                                         <span class="ot">NA</span>)),</span>
<span id="cb134-24"><a href="evaluate-model-performance.html#cb134-24" aria-hidden="true"></a>                            <span class="co"># And holdout:</span></span>
<span id="cb134-25"><a href="evaluate-model-performance.html#cb134-25" aria-hidden="true"></a>                            <span class="dt">xgbTree_rsq_holdout =</span> <span class="kw">unlist</span>(<span class="kw">map2</span>(xgbTree_holdout_predictions, actuals_holdout, evaluate_preds_rsq)),</span>
<span id="cb134-26"><a href="evaluate-model-performance.html#cb134-26" aria-hidden="true"></a>                            <span class="co"># Neural Network - RMSE - Test</span></span>
<span id="cb134-27"><a href="evaluate-model-performance.html#cb134-27" aria-hidden="true"></a>                            <span class="dt">nnet_rmse_test =</span> <span class="kw">unlist</span>(<span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb134-28"><a href="evaluate-model-performance.html#cb134-28" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(nnet_test_predictions, actuals_test, evaluate_preds_rmse),</span>
<span id="cb134-29"><a href="evaluate-model-performance.html#cb134-29" aria-hidden="true"></a>                                                         <span class="ot">NA</span>)),</span>
<span id="cb134-30"><a href="evaluate-model-performance.html#cb134-30" aria-hidden="true"></a>                            <span class="co"># And holdout:</span></span>
<span id="cb134-31"><a href="evaluate-model-performance.html#cb134-31" aria-hidden="true"></a>                            <span class="dt">nnet_rmse_holdout =</span> <span class="kw">unlist</span>(<span class="kw">map2</span>(nnet_holdout_predictions, actuals_holdout, evaluate_preds_rmse)),</span>
<span id="cb134-32"><a href="evaluate-model-performance.html#cb134-32" aria-hidden="true"></a>                            <span class="co"># Neural Network - R^2 - Test</span></span>
<span id="cb134-33"><a href="evaluate-model-performance.html#cb134-33" aria-hidden="true"></a>                            <span class="dt">nnet_rsq_test =</span> <span class="kw">unlist</span>(<span class="kw">ifelse</span>(split <span class="op">&lt;</span><span class="st"> </span><span class="dv">5</span>,</span>
<span id="cb134-34"><a href="evaluate-model-performance.html#cb134-34" aria-hidden="true"></a>                                                         <span class="kw">map2</span>(nnet_test_predictions, actuals_test, evaluate_preds_rsq),</span>
<span id="cb134-35"><a href="evaluate-model-performance.html#cb134-35" aria-hidden="true"></a>                                                         <span class="ot">NA</span>)),</span>
<span id="cb134-36"><a href="evaluate-model-performance.html#cb134-36" aria-hidden="true"></a>                            <span class="co"># And holdout:</span></span>
<span id="cb134-37"><a href="evaluate-model-performance.html#cb134-37" aria-hidden="true"></a>                            <span class="dt">nnet_rsq_holdout =</span> <span class="kw">unlist</span>(<span class="kw">map2</span>(nnet_holdout_predictions, actuals_holdout, evaluate_preds_rsq)))</span></code></pre></div>
<!-- Now we have RMSE values for every model created for every cryptocurrency and split of the data: -->
<!-- ```{r} -->
<!-- rmse_scores <- select(cryptodata_nested, lm_rmse_test, xgb_rmse_test, xgbTree_rmse_test, nnet_rmse_test) -->
<!-- # Show RMSE scores -->
<!-- rmse_scores -->
<!-- ``` -->
<!-- And the R Squared values: -->
<!-- ```{r} -->
<!-- rsq_scores <- select(cryptodata_nested, lm_rsq, xgb_rsq, xgbTree_rsq, nnet_rsq) -->
<!-- # Show R^2 scores -->
<!-- rsq_scores -->
<!-- ``` -->
</div>
</div>
<div id="eval-rmse" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Eval RMSE</h2>
<!-- [TODO - Title?] -->
<p>New object without split column <code>cryptodata_metrics</code>:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="evaluate-model-performance.html#cb135-1" aria-hidden="true"></a>cryptodata_metrics &lt;-<span class="st"> </span><span class="kw">group_by</span>(<span class="kw">select</span>(<span class="kw">ungroup</span>(cryptodata_nested),<span class="op">-</span>split),symbol)</span></code></pre></div>
<div id="test" class="section level3" number="7.5.1">
<h3><span class="header-section-number">7.5.1</span> Test</h3>
<p>Now for each model we will create a new column giving the average RMSE for the 4 cross-validation test splits:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="evaluate-model-performance.html#cb136-1" aria-hidden="true"></a>rmse_test &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_metrics,</span>
<span id="cb136-2"><a href="evaluate-model-performance.html#cb136-2" aria-hidden="true"></a>                      <span class="dt">lm =</span> <span class="kw">mean</span>(lm_rmse_test, <span class="dt">na.rm =</span> T),</span>
<span id="cb136-3"><a href="evaluate-model-performance.html#cb136-3" aria-hidden="true"></a>                      <span class="dt">xgb =</span> <span class="kw">mean</span>(xgb_rmse_test, <span class="dt">na.rm =</span> T),</span>
<span id="cb136-4"><a href="evaluate-model-performance.html#cb136-4" aria-hidden="true"></a>                      <span class="dt">xgbTree =</span> <span class="kw">mean</span>(xgbTree_rmse_test, <span class="dt">na.rm =</span> T),</span>
<span id="cb136-5"><a href="evaluate-model-performance.html#cb136-5" aria-hidden="true"></a>                      <span class="dt">nnet =</span> <span class="kw">mean</span>(nnet_rmse_test, <span class="dt">na.rm =</span> T))</span></code></pre></div>
<p>Now we can use the <code>gather()</code> function to summarize the columns as rows:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="evaluate-model-performance.html#cb137-1" aria-hidden="true"></a>rmse_test &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">gather</span>(<span class="kw">select</span>(rmse_test, lm<span class="op">:</span>nnet), <span class="st">&#39;model&#39;</span>, <span class="st">&#39;rmse&#39;</span>, <span class="op">-</span>symbol))</span>
<span id="cb137-2"><a href="evaluate-model-performance.html#cb137-2" aria-hidden="true"></a><span class="co"># Show results</span></span>
<span id="cb137-3"><a href="evaluate-model-performance.html#cb137-3" aria-hidden="true"></a>rmse_test</span></code></pre></div>
<pre><code>## [90m# A tibble: 196 x 3[39m
## [90m# Groups:   symbol [49][39m
##    symbol model  rmse
##    [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;chr&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m
## [90m 1[39m BTG    lm    0.891
## [90m 2[39m VET    lm    1.24 
## [90m 3[39m IHF    lm    0.774
## [90m 4[39m DGB    lm    1.63 
## [90m 5[39m LTC    lm    0.862
## [90m 6[39m NUT    lm    1.71 
## [90m 7[39m NEXO   lm    1.77 
## [90m 8[39m XMR    lm    0.941
## [90m 9[39m VIB    lm    3.26 
## [90m10[39m XDN    lm    1.58 
## [90m# … with 186 more rows[39m</code></pre>
<p>Now tag the results as having been for the test set</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="evaluate-model-performance.html#cb139-1" aria-hidden="true"></a>rmse_test<span class="op">$</span>eval_set &lt;-<span class="st"> &#39;test&#39;</span></span></code></pre></div>
</div>
<div id="holdout-3" class="section level3" number="7.5.2">
<h3><span class="header-section-number">7.5.2</span> Holdout</h3>
<p>Do the same for the holdout set</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="evaluate-model-performance.html#cb140-1" aria-hidden="true"></a>rmse_holdout &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_metrics,</span>
<span id="cb140-2"><a href="evaluate-model-performance.html#cb140-2" aria-hidden="true"></a>                      <span class="dt">lm =</span> <span class="kw">mean</span>(lm_rmse_holdout, <span class="dt">na.rm =</span> T),</span>
<span id="cb140-3"><a href="evaluate-model-performance.html#cb140-3" aria-hidden="true"></a>                      <span class="dt">xgb =</span> <span class="kw">mean</span>(xgb_rmse_holdout, <span class="dt">na.rm =</span> T),</span>
<span id="cb140-4"><a href="evaluate-model-performance.html#cb140-4" aria-hidden="true"></a>                      <span class="dt">xgbTree =</span> <span class="kw">mean</span>(xgbTree_rmse_holdout, <span class="dt">na.rm =</span> T),</span>
<span id="cb140-5"><a href="evaluate-model-performance.html#cb140-5" aria-hidden="true"></a>                      <span class="dt">nnet =</span> <span class="kw">mean</span>(nnet_rmse_holdout, <span class="dt">na.rm =</span> T))</span></code></pre></div>
<p>Now we can use the <code>gather()</code> function to summarize the columns as rows:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="evaluate-model-performance.html#cb141-1" aria-hidden="true"></a>rmse_holdout &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">gather</span>(<span class="kw">select</span>(rmse_holdout, lm<span class="op">:</span>nnet), <span class="st">&#39;model&#39;</span>, <span class="st">&#39;rmse&#39;</span>, <span class="op">-</span>symbol))</span>
<span id="cb141-2"><a href="evaluate-model-performance.html#cb141-2" aria-hidden="true"></a><span class="co"># Show results</span></span>
<span id="cb141-3"><a href="evaluate-model-performance.html#cb141-3" aria-hidden="true"></a>rmse_holdout</span></code></pre></div>
<pre><code>## [90m# A tibble: 196 x 3[39m
## [90m# Groups:   symbol [49][39m
##    symbol model  rmse
##    [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;chr&gt;[39m[23m [3m[90m&lt;dbl&gt;[39m[23m
## [90m 1[39m BTG    lm    0.987
## [90m 2[39m VET    lm    2.00 
## [90m 3[39m IHF    lm    6.61 
## [90m 4[39m DGB    lm    1.33 
## [90m 5[39m LTC    lm    1.17 
## [90m 6[39m NUT    lm    0.380
## [90m 7[39m NEXO   lm    1.87 
## [90m 8[39m XMR    lm    1.68 
## [90m 9[39m VIB    lm    5.01 
## [90m10[39m XDN    lm    3.31 
## [90m# … with 186 more rows[39m</code></pre>
<p>Now tag the results as having been for the holdout set</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="evaluate-model-performance.html#cb143-1" aria-hidden="true"></a>rmse_holdout<span class="op">$</span>eval_set &lt;-<span class="st"> &#39;holdout&#39;</span></span></code></pre></div>
</div>
<div id="union-results" class="section level3" number="7.5.3">
<h3><span class="header-section-number">7.5.3</span> Union Results</h3>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="evaluate-model-performance.html#cb144-1" aria-hidden="true"></a>rmse_scores &lt;-<span class="st"> </span><span class="kw">union</span>(rmse_test, rmse_holdout)</span></code></pre></div>
</div>
</div>
<div id="eval-r2" class="section level2" number="7.6">
<h2><span class="header-section-number">7.6</span> Eval R^2</h2>
<div id="test-1" class="section level3" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Test</h3>
<p>For each model we will create a new column giving the average R^2 for the 4 cross-validation test splits:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="evaluate-model-performance.html#cb145-1" aria-hidden="true"></a>rsq_test &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_metrics,</span>
<span id="cb145-2"><a href="evaluate-model-performance.html#cb145-2" aria-hidden="true"></a>                      <span class="dt">lm =</span> <span class="kw">mean</span>(lm_rsq_test, <span class="dt">na.rm =</span> T),</span>
<span id="cb145-3"><a href="evaluate-model-performance.html#cb145-3" aria-hidden="true"></a>                      <span class="dt">xgb =</span> <span class="kw">mean</span>(xgb_rsq_test, <span class="dt">na.rm =</span> T),</span>
<span id="cb145-4"><a href="evaluate-model-performance.html#cb145-4" aria-hidden="true"></a>                      <span class="dt">xgbTree =</span> <span class="kw">mean</span>(xgbTree_rsq_test, <span class="dt">na.rm =</span> T),</span>
<span id="cb145-5"><a href="evaluate-model-performance.html#cb145-5" aria-hidden="true"></a>                      <span class="dt">nnet =</span> <span class="kw">mean</span>(nnet_rsq_test, <span class="dt">na.rm =</span> T))</span></code></pre></div>
<p>Now we can use the <code>gather()</code> function to summarize the columns as rows:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="evaluate-model-performance.html#cb146-1" aria-hidden="true"></a>rsq_test &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">gather</span>(<span class="kw">select</span>(rsq_test, lm<span class="op">:</span>nnet), <span class="st">&#39;model&#39;</span>, <span class="st">&#39;rsq&#39;</span>, <span class="op">-</span>symbol))</span>
<span id="cb146-2"><a href="evaluate-model-performance.html#cb146-2" aria-hidden="true"></a><span class="co"># Show results</span></span>
<span id="cb146-3"><a href="evaluate-model-performance.html#cb146-3" aria-hidden="true"></a>rsq_test</span></code></pre></div>
<pre><code>## [90m# A tibble: 196 x 3[39m
## [90m# Groups:   symbol [49][39m
##    symbol model    rsq
##    [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;dbl&gt;[39m[23m
## [90m 1[39m BTG    lm    0.370 
## [90m 2[39m VET    lm    0.152 
## [90m 3[39m IHF    lm    0.125 
## [90m 4[39m DGB    lm    0.164 
## [90m 5[39m LTC    lm    0.075[4m4[24m
## [90m 6[39m NUT    lm    0.074[4m3[24m
## [90m 7[39m NEXO   lm    0.229 
## [90m 8[39m XMR    lm    0.199 
## [90m 9[39m VIB    lm    0.510 
## [90m10[39m XDN    lm    0.220 
## [90m# … with 186 more rows[39m</code></pre>
<p>Now tag the results as having been for the test set</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="evaluate-model-performance.html#cb148-1" aria-hidden="true"></a>rsq_test<span class="op">$</span>eval_set &lt;-<span class="st"> &#39;test&#39;</span></span></code></pre></div>
</div>
<div id="holdout-4" class="section level3" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Holdout</h3>
<p>Do the same for the holdout set</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="evaluate-model-performance.html#cb149-1" aria-hidden="true"></a>rsq_holdout &lt;-<span class="st"> </span><span class="kw">mutate</span>(cryptodata_metrics,</span>
<span id="cb149-2"><a href="evaluate-model-performance.html#cb149-2" aria-hidden="true"></a>                      <span class="dt">lm =</span> <span class="kw">mean</span>(lm_rsq_holdout, <span class="dt">na.rm =</span> T),</span>
<span id="cb149-3"><a href="evaluate-model-performance.html#cb149-3" aria-hidden="true"></a>                      <span class="dt">xgb =</span> <span class="kw">mean</span>(xgb_rsq_holdout, <span class="dt">na.rm =</span> T),</span>
<span id="cb149-4"><a href="evaluate-model-performance.html#cb149-4" aria-hidden="true"></a>                      <span class="dt">xgbTree =</span> <span class="kw">mean</span>(xgbTree_rsq_holdout, <span class="dt">na.rm =</span> T),</span>
<span id="cb149-5"><a href="evaluate-model-performance.html#cb149-5" aria-hidden="true"></a>                      <span class="dt">nnet =</span> <span class="kw">mean</span>(nnet_rsq_holdout, <span class="dt">na.rm =</span> T))</span></code></pre></div>
<p>Now we can use the <code>gather()</code> function to summarize the columns as rows:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="evaluate-model-performance.html#cb150-1" aria-hidden="true"></a>rsq_holdout &lt;-<span class="st"> </span><span class="kw">unique</span>(<span class="kw">gather</span>(<span class="kw">select</span>(rsq_holdout, lm<span class="op">:</span>nnet), <span class="st">&#39;model&#39;</span>, <span class="st">&#39;rsq&#39;</span>, <span class="op">-</span>symbol))</span>
<span id="cb150-2"><a href="evaluate-model-performance.html#cb150-2" aria-hidden="true"></a><span class="co"># Show results</span></span>
<span id="cb150-3"><a href="evaluate-model-performance.html#cb150-3" aria-hidden="true"></a>rsq_holdout</span></code></pre></div>
<pre><code>## [90m# A tibble: 196 x 3[39m
## [90m# Groups:   symbol [49][39m
##    symbol model      rsq
##    [3m[90m&lt;chr&gt;[39m[23m  [3m[90m&lt;chr&gt;[39m[23m    [3m[90m&lt;dbl&gt;[39m[23m
## [90m 1[39m BTG    lm    0.013[4m0[24m  
## [90m 2[39m VET    lm    0.976   
## [90m 3[39m IHF    lm    0.007[4m8[24m[4m5[24m 
## [90m 4[39m DGB    lm    0.001[4m8[24m[4m0[24m 
## [90m 5[39m LTC    lm    0.017[4m5[24m  
## [90m 6[39m NUT    lm    0.136   
## [90m 7[39m NEXO   lm    0.005[4m2[24m[4m0[24m 
## [90m 8[39m XMR    lm    0.000[4m4[24m[4m0[24m[4m3[24m
## [90m 9[39m VIB    lm    0.537   
## [90m10[39m XDN    lm    0.089[4m5[24m  
## [90m# … with 186 more rows[39m</code></pre>
<p>Now tag the results as having been for the holdout set</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="evaluate-model-performance.html#cb152-1" aria-hidden="true"></a>rsq_holdout<span class="op">$</span>eval_set &lt;-<span class="st"> &#39;holdout&#39;</span></span></code></pre></div>
</div>
<div id="union-results-1" class="section level3" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Union Results</h3>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="evaluate-model-performance.html#cb153-1" aria-hidden="true"></a>rsq_scores &lt;-<span class="st"> </span><span class="kw">union</span>(rsq_test, rsq_holdout)</span></code></pre></div>
</div>
</div>
<div id="visualize-results" class="section level2" number="7.7">
<h2><span class="header-section-number">7.7</span> Visualize Results</h2>
<div id="rmse-visualization" class="section level3" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> RMSE Visualization</h3>
<p>Now we can take the same tools we learned in the <a href="visualization.html#visualization">Visualization section from earlier</a> and visualize the results of the models.</p>
<!-- ```{r} -->
<!-- ggplot(rmse_scores, aes(x=split, y=rmse, color = model)) + -->
<!--   geom_boxplot() + -->
<!--   geom_point() + -->
<!--   ylim(c(0,50)) + -->
<!--   facet_wrap(~eval_set) -->
<!-- ``` -->
</div>
<div id="both" class="section level3" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> Both</h3>
<div id="join-datasets" class="section level4" number="7.7.2.1">
<h4><span class="header-section-number">7.7.2.1</span> Join Datasets</h4>
<p>First join the two</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="evaluate-model-performance.html#cb154-1" aria-hidden="true"></a>plot_scores &lt;-<span class="st"> </span><span class="kw">merge</span>(rmse_scores, rsq_scores)</span></code></pre></div>
</div>
<div id="plot-results" class="section level4" number="7.7.2.2">
<h4><span class="header-section-number">7.7.2.2</span> Plot Results</h4>
<!-- [TODO - ADJUST THESE SOME MORE] -->
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="evaluate-model-performance.html#cb155-1" aria-hidden="true"></a><span class="kw">ggplot</span>(plot_scores, <span class="kw">aes</span>(<span class="dt">x=</span>rsq, <span class="dt">y=</span>rmse, <span class="dt">color =</span> model)) <span class="op">+</span></span>
<span id="cb155-2"><a href="evaluate-model-performance.html#cb155-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb155-3"><a href="evaluate-model-performance.html#cb155-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>))</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>ADA only</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="evaluate-model-performance.html#cb156-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="kw">filter</span>(plot_scores, symbol <span class="op">==</span><span class="st"> &#39;ADA&#39;</span>), <span class="kw">aes</span>(<span class="dt">x=</span>rsq, <span class="dt">y=</span>rmse, <span class="dt">color =</span> model)) <span class="op">+</span></span>
<span id="cb156-2"><a href="evaluate-model-performance.html#cb156-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb156-3"><a href="evaluate-model-performance.html#cb156-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>eval_set)</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>Now by the cryptocurrency</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="evaluate-model-performance.html#cb157-1" aria-hidden="true"></a><span class="kw">ggplot</span>(plot_scores, <span class="kw">aes</span>(<span class="dt">x=</span>rsq, <span class="dt">y=</span>rmse, <span class="dt">color =</span> model)) <span class="op">+</span></span>
<span id="cb157-2"><a href="evaluate-model-performance.html#cb157-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb157-3"><a href="evaluate-model-performance.html#cb157-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>() <span class="op">+</span></span>
<span id="cb157-4"><a href="evaluate-model-performance.html#cb157-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">50</span>)) <span class="op">+</span></span>
<span id="cb157-5"><a href="evaluate-model-performance.html#cb157-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>symbol)</span></code></pre></div>
<p><img src="CryptoResearchPaper_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
</div>
<div id="results-by-the-cryptocurrency" class="section level3" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> Results by the Cryptocurrency</h3>
<!-- [TODO - UNCOMMENT THE CODE BELOW TO UPLOAD DATA TO PINS. ADD R LINE TO SET ENVIRONMENTAL VARIABLES BEFORE RUNNING BOOK!] -->
<!-- ```{r upload_results_pin, include=F} -->
<!-- source('pins_key.R') -->
<!-- # register board -->
<!-- board_register("github", repo = "predictcrypto/pins", token=Sys.getenv("pins_key")) -->
<!-- # Add current date -->
<!-- plot_scores$last_refreshed <- Sys.time() -->
<!-- # pin data -->
<!-- pin(plot_scores, board='github', name='crypto_tutorial_results_latest') -->
<!-- ``` -->
<!-- TODO - INCLUDE SHINYAPP HERE: -->
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="evaluate-model-performance.html#cb158-1" aria-hidden="true"></a>knitr<span class="op">::</span><span class="kw">include_app</span>(<span class="st">&#39;https://predictcrypto.shinyapps.io/tutorial_latest_model_summary/&#39;</span>, <span class="dt">height =</span> <span class="st">&#39;600px&#39;</span>)</span></code></pre></div>
<iframe src="https://predictcrypto.shinyapps.io/tutorial_latest_model_summary/?showcase=0" width="672" height="600px">
</iframe>
<p>The app shown above also has a button to <strong>Show Code</strong>. If you were to copy and paste that code into an RStudio session on your computer into a file with the .Rmd file extension and you then <em>Knit</em> the file, the same exact app should show up on your computer, no logins or setup outside of the packages required for the code to run; RStudio should automatically prompt you to install packages that are not currently installed on your computer.
<!-- [TODO - MAKE THE TEXT ABOVE AN INFO NOTE (NOT WARNING, JUST AN i FOR INFO)] --></p>
<!-- [TODO - HERE ALSO REMEMBER TO LOG MLFLOW METRICS AND WRITE THE SAME INFO TO THE DB] -->
<!-- SECRET: SAVE METRICS INTO MLFLOW -->

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="predictive-modeling.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="time-series.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": false,
"all": {}
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/ries9112/cryptocurrencyresearch-org/edit/master/06-EvaluateModelPerformance.Rmd",
"text": "Edit on GitHub"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/ries9112/cryptocurrencyresearch-org/blob/master/06-EvaluateModelPerformance.Rmd",
"text": "View Code on GitHub"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
